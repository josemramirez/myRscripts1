<!DOCTYPE html>
<!-- saved from url=(0014)about:internet -->
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>

<title>Title</title>

<style type="text/css">
body, td {
   font-family: sans-serif;
   background-color: white;
   font-size: 12px;
   margin: 8px;
}

tt, code, pre {
   font-family: 'DejaVu Sans Mono', 'Droid Sans Mono', 'Lucida Console', Consolas, Monaco, monospace;
}

h1 { 
   font-size:2.2em; 
}

h2 { 
   font-size:1.8em; 
}

h3 { 
   font-size:1.4em; 
}

h4 { 
   font-size:1.0em; 
}

h5 { 
   font-size:0.9em; 
}

h6 { 
   font-size:0.8em; 
}

a:visited {
   color: rgb(50%, 0%, 50%);
}

pre {	
   margin-top: 0;
   max-width: 95%;
   border: 1px solid #ccc;
   white-space: pre-wrap;
}

pre code {
   display: block; padding: 0.5em;
}

code.r, code.cpp {
   background-color: #F8F8F8;
}

table, td, th {
  border: none;
}

blockquote {
   color:#666666;
   margin:0;
   padding-left: 1em;
   border-left: 0.5em #EEE solid;
}

hr {
   height: 0px;
   border-bottom: none;
   border-top-width: thin;
   border-top-style: dotted;
   border-top-color: #999999;
}

@media print {
   * { 
      background: transparent !important; 
      color: black !important; 
      filter:none !important; 
      -ms-filter: none !important; 
   }

   body { 
      font-size:12pt; 
      max-width:100%; 
   }
       
   a, a:visited { 
      text-decoration: underline; 
   }

   hr { 
      visibility: hidden;
      page-break-before: always;
   }

   pre, blockquote { 
      padding-right: 1em; 
      page-break-inside: avoid; 
   }

   tr, img { 
      page-break-inside: avoid; 
   }

   img { 
      max-width: 100% !important; 
   }

   @page :left { 
      margin: 15mm 20mm 15mm 10mm; 
   }
     
   @page :right { 
      margin: 15mm 10mm 15mm 20mm; 
   }

   p, h2, h3 { 
      orphans: 3; widows: 3; 
   }

   h2, h3 { 
      page-break-after: avoid; 
   }
}

</style>

<!-- Styles for R syntax highlighter -->
<style type="text/css">
   pre .operator,
   pre .paren {
     color: rgb(104, 118, 135)
   }

   pre .literal {
     color: rgb(88, 72, 246)
   }

   pre .number {
     color: rgb(0, 0, 205);
   }

   pre .comment {
     color: rgb(76, 136, 107);
   }

   pre .keyword {
     color: rgb(0, 0, 255);
   }

   pre .identifier {
     color: rgb(0, 0, 0);
   }

   pre .string {
     color: rgb(3, 106, 7);
   }
</style>

<!-- R syntax highlighter -->
<script type="text/javascript">
var hljs=new function(){function m(p){return p.replace(/&/gm,"&amp;").replace(/</gm,"&lt;")}function f(r,q,p){return RegExp(q,"m"+(r.cI?"i":"")+(p?"g":""))}function b(r){for(var p=0;p<r.childNodes.length;p++){var q=r.childNodes[p];if(q.nodeName=="CODE"){return q}if(!(q.nodeType==3&&q.nodeValue.match(/\s+/))){break}}}function h(t,s){var p="";for(var r=0;r<t.childNodes.length;r++){if(t.childNodes[r].nodeType==3){var q=t.childNodes[r].nodeValue;if(s){q=q.replace(/\n/g,"")}p+=q}else{if(t.childNodes[r].nodeName=="BR"){p+="\n"}else{p+=h(t.childNodes[r])}}}if(/MSIE [678]/.test(navigator.userAgent)){p=p.replace(/\r/g,"\n")}return p}function a(s){var r=s.className.split(/\s+/);r=r.concat(s.parentNode.className.split(/\s+/));for(var q=0;q<r.length;q++){var p=r[q].replace(/^language-/,"");if(e[p]){return p}}}function c(q){var p=[];(function(s,t){for(var r=0;r<s.childNodes.length;r++){if(s.childNodes[r].nodeType==3){t+=s.childNodes[r].nodeValue.length}else{if(s.childNodes[r].nodeName=="BR"){t+=1}else{if(s.childNodes[r].nodeType==1){p.push({event:"start",offset:t,node:s.childNodes[r]});t=arguments.callee(s.childNodes[r],t);p.push({event:"stop",offset:t,node:s.childNodes[r]})}}}}return t})(q,0);return p}function k(y,w,x){var q=0;var z="";var s=[];function u(){if(y.length&&w.length){if(y[0].offset!=w[0].offset){return(y[0].offset<w[0].offset)?y:w}else{return w[0].event=="start"?y:w}}else{return y.length?y:w}}function t(D){var A="<"+D.nodeName.toLowerCase();for(var B=0;B<D.attributes.length;B++){var C=D.attributes[B];A+=" "+C.nodeName.toLowerCase();if(C.value!==undefined&&C.value!==false&&C.value!==null){A+='="'+m(C.value)+'"'}}return A+">"}while(y.length||w.length){var v=u().splice(0,1)[0];z+=m(x.substr(q,v.offset-q));q=v.offset;if(v.event=="start"){z+=t(v.node);s.push(v.node)}else{if(v.event=="stop"){var p,r=s.length;do{r--;p=s[r];z+=("</"+p.nodeName.toLowerCase()+">")}while(p!=v.node);s.splice(r,1);while(r<s.length){z+=t(s[r]);r++}}}}return z+m(x.substr(q))}function j(){function q(x,y,v){if(x.compiled){return}var u;var s=[];if(x.k){x.lR=f(y,x.l||hljs.IR,true);for(var w in x.k){if(!x.k.hasOwnProperty(w)){continue}if(x.k[w] instanceof Object){u=x.k[w]}else{u=x.k;w="keyword"}for(var r in u){if(!u.hasOwnProperty(r)){continue}x.k[r]=[w,u[r]];s.push(r)}}}if(!v){if(x.bWK){x.b="\\b("+s.join("|")+")\\s"}x.bR=f(y,x.b?x.b:"\\B|\\b");if(!x.e&&!x.eW){x.e="\\B|\\b"}if(x.e){x.eR=f(y,x.e)}}if(x.i){x.iR=f(y,x.i)}if(x.r===undefined){x.r=1}if(!x.c){x.c=[]}x.compiled=true;for(var t=0;t<x.c.length;t++){if(x.c[t]=="self"){x.c[t]=x}q(x.c[t],y,false)}if(x.starts){q(x.starts,y,false)}}for(var p in e){if(!e.hasOwnProperty(p)){continue}q(e[p].dM,e[p],true)}}function d(B,C){if(!j.called){j();j.called=true}function q(r,M){for(var L=0;L<M.c.length;L++){if((M.c[L].bR.exec(r)||[null])[0]==r){return M.c[L]}}}function v(L,r){if(D[L].e&&D[L].eR.test(r)){return 1}if(D[L].eW){var M=v(L-1,r);return M?M+1:0}return 0}function w(r,L){return L.i&&L.iR.test(r)}function K(N,O){var M=[];for(var L=0;L<N.c.length;L++){M.push(N.c[L].b)}var r=D.length-1;do{if(D[r].e){M.push(D[r].e)}r--}while(D[r+1].eW);if(N.i){M.push(N.i)}return f(O,M.join("|"),true)}function p(M,L){var N=D[D.length-1];if(!N.t){N.t=K(N,E)}N.t.lastIndex=L;var r=N.t.exec(M);return r?[M.substr(L,r.index-L),r[0],false]:[M.substr(L),"",true]}function z(N,r){var L=E.cI?r[0].toLowerCase():r[0];var M=N.k[L];if(M&&M instanceof Array){return M}return false}function F(L,P){L=m(L);if(!P.k){return L}var r="";var O=0;P.lR.lastIndex=0;var M=P.lR.exec(L);while(M){r+=L.substr(O,M.index-O);var N=z(P,M);if(N){x+=N[1];r+='<span class="'+N[0]+'">'+M[0]+"</span>"}else{r+=M[0]}O=P.lR.lastIndex;M=P.lR.exec(L)}return r+L.substr(O,L.length-O)}function J(L,M){if(M.sL&&e[M.sL]){var r=d(M.sL,L);x+=r.keyword_count;return r.value}else{return F(L,M)}}function I(M,r){var L=M.cN?'<span class="'+M.cN+'">':"";if(M.rB){y+=L;M.buffer=""}else{if(M.eB){y+=m(r)+L;M.buffer=""}else{y+=L;M.buffer=r}}D.push(M);A+=M.r}function G(N,M,Q){var R=D[D.length-1];if(Q){y+=J(R.buffer+N,R);return false}var P=q(M,R);if(P){y+=J(R.buffer+N,R);I(P,M);return P.rB}var L=v(D.length-1,M);if(L){var O=R.cN?"</span>":"";if(R.rE){y+=J(R.buffer+N,R)+O}else{if(R.eE){y+=J(R.buffer+N,R)+O+m(M)}else{y+=J(R.buffer+N+M,R)+O}}while(L>1){O=D[D.length-2].cN?"</span>":"";y+=O;L--;D.length--}var r=D[D.length-1];D.length--;D[D.length-1].buffer="";if(r.starts){I(r.starts,"")}return R.rE}if(w(M,R)){throw"Illegal"}}var E=e[B];var D=[E.dM];var A=0;var x=0;var y="";try{var s,u=0;E.dM.buffer="";do{s=p(C,u);var t=G(s[0],s[1],s[2]);u+=s[0].length;if(!t){u+=s[1].length}}while(!s[2]);if(D.length>1){throw"Illegal"}return{r:A,keyword_count:x,value:y}}catch(H){if(H=="Illegal"){return{r:0,keyword_count:0,value:m(C)}}else{throw H}}}function g(t){var p={keyword_count:0,r:0,value:m(t)};var r=p;for(var q in e){if(!e.hasOwnProperty(q)){continue}var s=d(q,t);s.language=q;if(s.keyword_count+s.r>r.keyword_count+r.r){r=s}if(s.keyword_count+s.r>p.keyword_count+p.r){r=p;p=s}}if(r.language){p.second_best=r}return p}function i(r,q,p){if(q){r=r.replace(/^((<[^>]+>|\t)+)/gm,function(t,w,v,u){return w.replace(/\t/g,q)})}if(p){r=r.replace(/\n/g,"<br>")}return r}function n(t,w,r){var x=h(t,r);var v=a(t);var y,s;if(v){y=d(v,x)}else{return}var q=c(t);if(q.length){s=document.createElement("pre");s.innerHTML=y.value;y.value=k(q,c(s),x)}y.value=i(y.value,w,r);var u=t.className;if(!u.match("(\\s|^)(language-)?"+v+"(\\s|$)")){u=u?(u+" "+v):v}if(/MSIE [678]/.test(navigator.userAgent)&&t.tagName=="CODE"&&t.parentNode.tagName=="PRE"){s=t.parentNode;var p=document.createElement("div");p.innerHTML="<pre><code>"+y.value+"</code></pre>";t=p.firstChild.firstChild;p.firstChild.cN=s.cN;s.parentNode.replaceChild(p.firstChild,s)}else{t.innerHTML=y.value}t.className=u;t.result={language:v,kw:y.keyword_count,re:y.r};if(y.second_best){t.second_best={language:y.second_best.language,kw:y.second_best.keyword_count,re:y.second_best.r}}}function o(){if(o.called){return}o.called=true;var r=document.getElementsByTagName("pre");for(var p=0;p<r.length;p++){var q=b(r[p]);if(q){n(q,hljs.tabReplace)}}}function l(){if(window.addEventListener){window.addEventListener("DOMContentLoaded",o,false);window.addEventListener("load",o,false)}else{if(window.attachEvent){window.attachEvent("onload",o)}else{window.onload=o}}}var e={};this.LANGUAGES=e;this.highlight=d;this.highlightAuto=g;this.fixMarkup=i;this.highlightBlock=n;this.initHighlighting=o;this.initHighlightingOnLoad=l;this.IR="[a-zA-Z][a-zA-Z0-9_]*";this.UIR="[a-zA-Z_][a-zA-Z0-9_]*";this.NR="\\b\\d+(\\.\\d+)?";this.CNR="\\b(0[xX][a-fA-F0-9]+|(\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)";this.BNR="\\b(0b[01]+)";this.RSR="!|!=|!==|%|%=|&|&&|&=|\\*|\\*=|\\+|\\+=|,|\\.|-|-=|/|/=|:|;|<|<<|<<=|<=|=|==|===|>|>=|>>|>>=|>>>|>>>=|\\?|\\[|\\{|\\(|\\^|\\^=|\\||\\|=|\\|\\||~";this.ER="(?![\\s\\S])";this.BE={b:"\\\\.",r:0};this.ASM={cN:"string",b:"'",e:"'",i:"\\n",c:[this.BE],r:0};this.QSM={cN:"string",b:'"',e:'"',i:"\\n",c:[this.BE],r:0};this.CLCM={cN:"comment",b:"//",e:"$"};this.CBLCLM={cN:"comment",b:"/\\*",e:"\\*/"};this.HCM={cN:"comment",b:"#",e:"$"};this.NM={cN:"number",b:this.NR,r:0};this.CNM={cN:"number",b:this.CNR,r:0};this.BNM={cN:"number",b:this.BNR,r:0};this.inherit=function(r,s){var p={};for(var q in r){p[q]=r[q]}if(s){for(var q in s){p[q]=s[q]}}return p}}();hljs.LANGUAGES.cpp=function(){var a={keyword:{"false":1,"int":1,"float":1,"while":1,"private":1,"char":1,"catch":1,"export":1,virtual:1,operator:2,sizeof:2,dynamic_cast:2,typedef:2,const_cast:2,"const":1,struct:1,"for":1,static_cast:2,union:1,namespace:1,unsigned:1,"long":1,"throw":1,"volatile":2,"static":1,"protected":1,bool:1,template:1,mutable:1,"if":1,"public":1,friend:2,"do":1,"return":1,"goto":1,auto:1,"void":2,"enum":1,"else":1,"break":1,"new":1,extern:1,using:1,"true":1,"class":1,asm:1,"case":1,typeid:1,"short":1,reinterpret_cast:2,"default":1,"double":1,register:1,explicit:1,signed:1,typename:1,"try":1,"this":1,"switch":1,"continue":1,wchar_t:1,inline:1,"delete":1,alignof:1,char16_t:1,char32_t:1,constexpr:1,decltype:1,noexcept:1,nullptr:1,static_assert:1,thread_local:1,restrict:1,_Bool:1,complex:1},built_in:{std:1,string:1,cin:1,cout:1,cerr:1,clog:1,stringstream:1,istringstream:1,ostringstream:1,auto_ptr:1,deque:1,list:1,queue:1,stack:1,vector:1,map:1,set:1,bitset:1,multiset:1,multimap:1,unordered_set:1,unordered_map:1,unordered_multiset:1,unordered_multimap:1,array:1,shared_ptr:1}};return{dM:{k:a,i:"</",c:[hljs.CLCM,hljs.CBLCLM,hljs.QSM,{cN:"string",b:"'\\\\?.",e:"'",i:"."},{cN:"number",b:"\\b(\\d+(\\.\\d*)?|\\.\\d+)(u|U|l|L|ul|UL|f|F)"},hljs.CNM,{cN:"preprocessor",b:"#",e:"$"},{cN:"stl_container",b:"\\b(deque|list|queue|stack|vector|map|set|bitset|multiset|multimap|unordered_map|unordered_set|unordered_multiset|unordered_multimap|array)\\s*<",e:">",k:a,r:10,c:["self"]}]}}}();hljs.LANGUAGES.r={dM:{c:[hljs.HCM,{cN:"number",b:"\\b0[xX][0-9a-fA-F]+[Li]?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+(?:[eE][+\\-]?\\d*)?L\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+\\.(?!\\d)(?:i\\b)?",e:hljs.IMMEDIATE_RE,r:1},{cN:"number",b:"\\b\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\.\\d+(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"keyword",b:"(?:tryCatch|library|setGeneric|setGroupGeneric)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\.",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\d+(?![\\w.])",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\b(?:function)",e:hljs.IMMEDIATE_RE,r:2},{cN:"keyword",b:"(?:if|in|break|next|repeat|else|for|return|switch|while|try|stop|warning|require|attach|detach|source|setMethod|setClass)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"literal",b:"(?:NA|NA_integer_|NA_real_|NA_character_|NA_complex_)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"literal",b:"(?:NULL|TRUE|FALSE|T|F|Inf|NaN)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"identifier",b:"[a-zA-Z.][a-zA-Z0-9._]*\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"<\\-(?!\\s*\\d)",e:hljs.IMMEDIATE_RE,r:2},{cN:"operator",b:"\\->|<\\-",e:hljs.IMMEDIATE_RE,r:1},{cN:"operator",b:"%%|~",e:hljs.IMMEDIATE_RE},{cN:"operator",b:">=|<=|==|!=|\\|\\||&&|=|\\+|\\-|\\*|/|\\^|>|<|!|&|\\||\\$|:",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"%",e:"%",i:"\\n",r:1},{cN:"identifier",b:"`",e:"`",r:0},{cN:"string",b:'"',e:'"',c:[hljs.BE],r:0},{cN:"string",b:"'",e:"'",c:[hljs.BE],r:0},{cN:"paren",b:"[[({\\])}]",e:hljs.IMMEDIATE_RE,r:0}]}};
hljs.initHighlightingOnLoad();
</script>




</head>

<body>
<h1>Title</h1>

<p>This is an example document.  Here&#39;s a summary of some data:</p>

<pre><code class="r">
library(MASS)
library(&quot;nls2&quot;, lib.loc = &quot;/Users/josem/software/Rsoftware/&quot;)
</code></pre>

<pre><code>## Loading required package: proto
</code></pre>

<pre><code class="r">library(&quot;proto&quot;, lib.loc = &quot;/Users/josem/software/Rsoftware/&quot;)

# %%%%%%%%%%%%%%% Constantes fisicas... %%%%%%%%%%%%%%%%%%%%%%%%%
zgal = 0.00964723
hv = 12.39852
cluz = 299792.458
vgal = zgal * cluz
# %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

## Lee un archivo

## Para la lista final..
myfile_final1 &lt;- &quot;../Log1.15_Nvar_ID_smart_v2/ids1/ID_lines.txt&quot;
################################################################################ Abre un dispositivo..
################################################################################ myfile_wt2&lt;-paste(as.character(file_root),&#39;_TODO.pdf&#39;,sep = &#39;&#39;, collapse =
################################################################################ NULL)
myfile_wt2 &lt;- &quot;vel_Peaks.eps&quot;
# pdf(myfile_wt2,width=14.,height=8.,pointsize=17)
# postscript(myfile_wt2,width=14.,height=8.,pointsize=17)
postscript(myfile_wt2, width = 12, height = 8, pointsize = 14, onefile = FALSE, 
    encoding = &quot;TeXtext.enc&quot;)
#### Sector de Ploteo!!
par(mfrow = c(1, 1))
## margin for side 2 is 7 lines in size
op &lt;- par(mar = c(5, 6, 4, 2) + 0.1)  ## default is c(5,4,4,2) + 0.1
#################################### 

## Todo en vel2
vel2 &lt;- read.table(myfile_final1, header = F)
vel2
</code></pre>

<pre><code>##      V1    V2     V3     V4       V5     V6       V7   V8  V9 V10 V11 V12
## 1     1     0  3.489      0 Un_known  3.489 0.00e+00 0.00  62  19  20  62
## 2     2     0  3.731      0 Un_known  3.731 0.00e+00 0.00  66  16  16  66
## 3     3 47978  3.825 -23452    ar_xi  4.149 1.54e-04 1.15  35  11  11  35
## 4     4 47936  3.892 -20476     ar_x  4.178 1.19e-04 1.15  82  34  34  82
## 5     5 47978  3.954 -14142    ar_xi  4.149 1.54e-04 1.15 144  61  63 144
## 6     6 47936  3.974 -14613     ar_x  4.178 1.19e-04 1.15  70  18  19  70
## 7     7 47978  4.076  -5269    ar_xi  4.149 1.54e-04 1.15 107  29  29 107
## 8     8 47936  4.291   8109     ar_x  4.178 1.19e-04 1.15  56  23  23  56
## 9     9 47936  4.352  12516     ar_x  4.178 1.19e-04 1.15  43  11  11  43
## 10   10     0  4.587      0 Un_known  4.587 0.00e+00 0.00  57  44  47  57
## 11   11     0  4.615      0 Un_known  4.615 0.00e+00 0.00 135  60  63 135
## 12   12     0  4.719      0 Un_known  4.719 0.00e+00 0.00  30   6   6  30
## 13   13 26299  4.937 -21729     s_ix  5.323 8.11e-04 1.15 132  42  43 132
## 14   14 26314  5.027 -14381      s_x  5.280 3.20e-04 1.15  31   9   9  31
## 15   15 26299  5.079 -13736     s_ix  5.323 8.11e-04 1.15  49  12  12  49
## 16   16 26314  5.118  -9202      s_x  5.280 3.20e-04 1.15  30  13  13  30
## 17   17 26299  5.173  -8437     s_ix  5.323 8.11e-04 1.15 137  27  28 137
## 18   18 26314  5.208  -4096      s_x  5.280 3.20e-04 1.15  68  16  16  68
## 19   19 26299  5.272  -2904     s_ix  5.323 8.11e-04 1.15  68  20  20  68
## 20   20 26314  5.404   7050      s_x  5.280 3.20e-04 1.15  79  20  21  79
## 21   21     0  5.666      0 Un_known  5.666 0.00e+00 0.00  64  11  11  64
## 22   22     0  5.739      0 Un_known  5.739 0.00e+00 0.00  32  15  16  32
## 23   23     0  6.037      0 Un_known  6.037 0.00e+00 0.00  78  11  11  78
## 24   24     0  6.168      0 Un_known  6.168 0.00e+00 0.00  45   4   4  45
## 25   25 20264  6.634 -15879  si_viii  7.005 2.23e-03 1.15  40   6   6  40
## 26   26 20822  6.712  -9793    si_ix  6.938 1.69e-03 1.15  39  10  10  39
## 27   27 20264  6.769 -10067  si_viii  7.005 2.23e-03 1.15  39   8   8  39
## 28   28 20822  6.841  -4178    si_ix  6.938 1.69e-03 1.15  86   8   8  86
## 29   29 20264  6.914  -3886  si_viii  7.005 2.23e-03 1.15 101  10  10 101
## 30   30 20822  6.983   1937    si_ix  6.938 1.69e-03 1.15 104  15  15 104
## 31   31 20264  7.030   1078  si_viii  7.005 2.23e-03 1.15  40  15  15  40
## 32   32 20822  7.089   6521    si_ix  6.938 1.69e-03 1.15  69  11  11  69
## 33   33 20264  7.159   6623  si_viii  7.005 2.23e-03 1.15  23  10  10  23
## 34   34 11639  7.298  -7029    mg_xi  7.473 1.26e-04 1.15  40  15  15  40
## 35   35 11634  7.458 -14979    mg_xi  7.851 3.85e-04 1.15 142  19  20 142
## 36   36 11639  7.631   6350    mg_xi  7.473 1.26e-04 1.15  72  16  17  72
## 37   37 11634  7.693  -6019    mg_xi  7.851 3.85e-04 1.15 104  21  21 104
## 38   38 11634  7.748  -3924    mg_xi  7.851 3.85e-04 1.15  38  13  13  38
## 39   39 11634  7.839   -425    mg_xi  7.851 3.85e-04 1.15  67   9   9  67
## 40   40 11634  7.910   2276    mg_xi  7.851 3.85e-04 1.15 145  25  25 145
## 41   41 11634  7.977   4825    mg_xi  7.851 3.85e-04 1.15  37  16  16  37
## 42   42     0  8.082      0 Un_known  8.082 0.00e+00 0.00 102  18  18 102
## 43   43     0  8.146      0 Un_known  8.146 0.00e+00 0.00 109  18  18 109
## 44   44     0  8.297      0 Un_known  8.297 0.00e+00 0.00 121  20  20 121
## 45   45     0  8.402      0 Un_known  8.402 0.00e+00 0.00  88   9   9  88
## 46   46     0  8.557      0 Un_known  8.557 0.00e+00 0.00  37  11  11  37
## 47   47     0  8.713      0 Un_known  8.713 0.00e+00 0.00 221  25  26 221
## 48   48 11615  8.796 -12204    mg_xi  9.169 2.20e-03 1.15  67  15  15  67
## 49   49 11548  8.969 -10132     mg_x  9.283 2.24e-03 1.15 111  14  15 111
## 50   50 11376  9.060 -10385    mg_ix  9.386 9.12e-03 1.15 149  27  27 149
## 51   51 11024  9.154 -10986  mg_viii  9.502 3.22e-03 1.15  86  16  16  86
## 52   52 11376  9.222  -5231    mg_ix  9.386 9.12e-03 1.15  65  14  14  65
## 53   53 11024  9.266  -7445  mg_viii  9.502 3.22e-03 1.15  24   8   8  24
## 54   54 11376  9.360   -805    mg_ix  9.386 9.12e-03 1.15 187  20  21 187
## 55   55 11024  9.360  -4502  mg_viii  9.502 3.22e-03 1.15  62  10  11  62
## 56   56 11376  9.463   2469    mg_ix  9.386 9.12e-03 1.15  86   7   7  86
## 57   57 11024  9.687   5835  mg_viii  9.502 3.22e-03 1.15  97   8   8  97
## 58   58 10151  9.772   5036   mg_vii  9.611 5.43e-04 1.15  89  12  12  89
## 59   59     0  9.832      0 Un_known  9.832 0.00e+00 0.00 112  14  14 112
## 60   60  9197  9.978  -7672     ne_x 10.240 1.27e-04 1.15  23  10  10  23
## 61   61  9197 10.028  -6214     ne_x 10.240 1.27e-04 1.15  82  12  12  82
## 62   62  9197 10.101  -4062     ne_x 10.240 1.27e-04 1.15 133  15  16 133
## 63   63  9197 10.216   -713     ne_x 10.240 1.27e-04 1.15  84  12  12  84
## 64   64  9197 10.339   2886     ne_x 10.240 1.27e-04 1.15  34  12  12  34
## 65   65  9081 10.498  -7845    ne_ix 10.780 3.49e-04 1.15  62  13  14  62
## 66   66  9267 10.619 -10469     na_x 11.003 1.27e-03 1.15  77  11  11  77
## 67   67  9074 10.754  -6604    ne_ix 10.996 7.31e-04 1.15 131  26  27 131
## 68   68  9267 10.798  -5577     na_x 11.003 1.27e-03 1.15  96  12  12  96
## 69   69  9074 10.975   -575    ne_ix 10.996 7.31e-04 1.15  57   7   7  57
## 70   70  9267 11.111   2946     na_x 11.003 1.27e-03 1.15  96  14  14  96
## 71   71  9073 11.232  -8187    ne_ix 11.547 2.04e-03 1.15 133  28  29 133
## 72   72  9073 11.300  -6421    ne_ix 11.547 2.04e-03 1.15 104  20  20 104
## 73   73  9073 11.404  -3721    ne_ix 11.547 2.04e-03 1.15  59  10  10  59
## 74   74  9073 11.469  -2016    ne_ix 11.547 2.04e-03 1.15 144  28  28 144
## 75   75  9073 11.516   -815    ne_ix 11.547 2.04e-03 1.15  21   6   6  21
## 76   76  9194 11.748  -9526     ne_x 12.134 1.57e-03 1.15 111  11  11 111
## 77   77  9194 11.794  -8405     ne_x 12.134 1.57e-03 1.15 238 104 111 238
## 78   78  9194 11.917  -5365     ne_x 12.134 1.57e-03 1.15 143  41  42 143
## 79   79  9194 11.954  -4438     ne_x 12.134 1.57e-03 1.15  32   9   9  32
## 80   80  9194 12.011  -3041     ne_x 12.134 1.57e-03 1.15  90  21  21  90
## 81   81  9194 12.099   -853     ne_x 12.134 1.57e-03 1.15  98   7   7  98
## 82   82  9194 12.169    862     ne_x 12.134 1.57e-03 1.15  90  11  11  90
## 83   83  9194 12.252   2930     ne_x 12.134 1.57e-03 1.15  77   8   8  77
## 84   84     0 12.408      0 Un_known 12.408 0.00e+00 0.00  39  10  10  39
## 85   85     0 12.553      0 Un_known 12.553 0.00e+00 0.00  56  12  12  56
## 86   86     0 12.633      0 Un_known 12.633 0.00e+00 0.00  96  15  15  96
## 87   87     0 12.726      0 Un_known 12.726 0.00e+00 0.00  33  13  13  33
## 88   88     0 12.807      0 Un_known 12.807 0.00e+00 0.00  52   8   8  52
## 89   89     0 12.910      0 Un_known 12.910 0.00e+00 0.00 228  16  16 228
## 90   90     0 13.020      0 Un_known 13.020 0.00e+00 0.00  93  15  15  93
## 91   91  9125 13.297  -3333    ne_ix 13.447 1.15e-02 1.15  22  10  10  22
## 92   92  9007 13.332  -7055  ne_viii 13.653 4.45e-03 1.15  14   9   9  14
## 93   93  9125 13.409   -855    ne_ix 13.447 1.15e-02 1.15  87  11  11  87
## 94   94  8761 13.489  -7399   ne_vii 13.830 1.01e-02 1.15  53   8   8  53
## 95   95  9007 13.786   2923  ne_viii 13.653 4.45e-03 1.15  98  12  12  98
## 96   96  8494 14.130   2132    ne_vi 14.030 1.38e-03 1.15  18  10  10  18
## 97   97  8293 14.177   2654    ne_vi 14.053 7.64e-04 1.15  34  10  10  34
## 98   98  8404 14.236   3947    ne_vi 14.051 4.91e-04 1.15 121  19  19 121
## 99   99  5832 14.347  -6115   o_viii 14.645 4.60e-03 1.15  56  10  10  56
## 100 100  5791 14.433  -8062   o_viii 14.832 8.32e-03 1.15  37  11  12  37
## 101 101  5832 14.512  -2725   o_viii 14.645 4.60e-03 1.15  35   6   6  35
## 102 102  5791 14.562  -5453   o_viii 14.832 8.32e-03 1.15  20  10  10  20
## 103 103  5832 14.612   -675   o_viii 14.645 4.60e-03 1.15  66  12  12  66
## 104 104  5808 14.807  -7512   o_viii 15.188 1.77e-02 1.15  81  15  15  81
## 105 105  5791 14.944   2271   o_viii 14.832 8.32e-03 1.15  22   9   9  22
## 106 106  5808 14.979  -4110   o_viii 15.188 1.77e-02 1.15  85  13  13  85
## 107 107  5808 15.156   -620   o_viii 15.188 1.77e-02 1.15 170  25  26 170
## 108 108  5808 15.230    831   o_viii 15.188 1.77e-02 1.15  63  10  10  63
## 109 109 95591 15.976    263   fe_xii 15.962 4.95e+08 1.15  89  13  13  89
## 110 110 94282 17.159   1927  fe_viii 17.049 8.43e+09 1.15 163  23  23 163
## 111 111 92737 17.346   2135   fe_vii 17.223 4.90e+06 1.15 159  16  16 159
## 112 112  5678 17.725   -732    o_vii 17.768 4.48e-02 1.15  57  13  13  57
## 113 113  5792 18.584  -6083   o_viii 18.969 3.17e-01 1.15  64   9   9  64
## 114 114  2977 18.918  -3304    n_vii 19.129 1.21e-03 1.15  39  10  10  39
## 115 115  2983 19.285  -1352    n_vii 19.372 2.19e-03 1.15  22  10  10  22
## 116 116  2984 19.789   -724    n_vii 19.837 4.66e-03 1.15  31   9   9  31
## 117 117  2980 20.873   -531    n_vii 20.910 1.34e-02 1.15  88  14  14  88
##     V13 V14 V15
## 1    19  20  UR
## 2    16  16   R
## 3    11  11  UR
## 4    34  34   R
## 5    61  63   R
## 6    18  19   R
## 7    29  29   R
## 8    23  23   R
## 9    11  11  UR
## 10   44  47   R
## 11   60  63   R
## 12    6   6   R
## 13   42  43   R
## 14    9   9   R
## 15   12  12   R
## 16   13  13   R
## 17   27  28   R
## 18   16  16   R
## 19   20  20   R
## 20   20  21   R
## 21   11  11   R
## 22   15  16   R
## 23   11  11   R
## 24    4   4   R
## 25    6   6   R
## 26   10  10   R
## 27    8   8   R
## 28    8   8   R
## 29   10  10   R
## 30   15  15   R
## 31   15  15  UR
## 32   11  11   R
## 33   10  10  UR
## 34   15  15  UR
## 35   19  20   R
## 36   16  17   R
## 37   21  21   R
## 38   13  13   R
## 39    9   9   R
## 40   25  25   R
## 41   16  16   R
## 42   18  18   R
## 43   18  18   R
## 44   20  20   R
## 45    9   9   R
## 46   11  11   R
## 47   25  26   R
## 48   15  15   R
## 49   14  15   R
## 50   27  27   R
## 51   16  16   R
## 52   14  14   R
## 53    8   8   R
## 54   20  21   R
## 55   10  11   R
## 56    7   7   R
## 57    8   8   R
## 58   12  12   R
## 59   14  14   R
## 60   10  10   R
## 61   12  12   R
## 62   15  16   R
## 63   12  12   R
## 64   12  12  UR
## 65   13  14   R
## 66   11  11   R
## 67   26  27   R
## 68   12  12   R
## 69    7   7   R
## 70   14  14   R
## 71   28  29   R
## 72   20  20   R
## 73   10  10   R
## 74   28  28   R
## 75    6   6   R
## 76   11  11   R
## 77  104 111   R
## 78   41  42   R
## 79    9   9   R
## 80   21  21   R
## 81    7   7   R
## 82   11  11   R
## 83    8   8   R
## 84   10  10   R
## 85   12  12   R
## 86   15  15   R
## 87   13  13   R
## 88    8   8   R
## 89   16  16   R
## 90   15  15   R
## 91   10  10   R
## 92    9   9  UR
## 93   11  11   R
## 94    8   8   R
## 95   12  12   R
## 96   10  10  UR
## 97   10  10   R
## 98   19  19   R
## 99   10  10   R
## 100  11  12   R
## 101   6   6   R
## 102  10  10  UR
## 103  12  12   R
## 104  15  15   R
## 105   9   9   R
## 106  13  13   R
## 107  25  26   R
## 108  10  10   R
## 109  13  13   R
## 110  23  23   R
## 111  16  16   R
## 112  13  13   R
## 113   9   9   R
## 114  10  10   R
## 115  10  10   R
## 116   9   9  UR
## 117  14  14   R
</code></pre>

<pre><code class="r">## Luego las cantidades..
x &lt;- vel2[, 4]
# i_good_NO_unknows=which(x!=0) x &lt;- x[i_good_NO_unknows] lines(density(x,
# bw=&#39;SJ&#39;, adjust=1/6),col=2,lwd=5) rug(x)

#### Para el super average de los tres estados y los peaks!!..

### DATA global
sims_global &lt;- matrix(c(x, x, x), ncol = 3, nrow = length(x))



## Data 2
sims &lt;- matrix(c(x, x, x, x, x, x, x, x, x, x), ncol = 10, nrow = length(x))
# print(sims) Todo en vel2
arr1 = c(1, 2, 3, 4, 5, 6, 7, 8, 9, 10)
count = 1
for (i in arr1) {
    myfile_rd &lt;- paste(&quot;../Log1.15_Nvar_ID_smart_v2/ids&quot;, as.character(i), &quot;/ID_lines.txt&quot;, 
        sep = &quot;&quot;, collapse = NULL)
    ## 
    myfile_rd

    vel2 &lt;- read.table(myfile_rd, header = F)
    vel2
    ## Luego las cantidades..
    x &lt;- vel2[, 4]
    # i_good_NO_unknows=which(x!=0) x &lt;- x[i_good_NO_unknows]

    sims[, count] = x
    # print(sims)

    ### lines(density(x, bw=&#39;SJ&#39;, adjust=1/6),col=coly1,lwd=5)
    count = count + 1
    ################################################################################ 
}


########################## Data global!! ########
count_global = 1
means_for_global &lt;- rowMeans(sims, na.rm = FALSE)
sims_global[, count_global] &lt;- means_for_global
########################## 



sims[sims == 0] &lt;- NA
means &lt;- rowMeans(sims, na.rm = TRUE)
length(means)
</code></pre>

<pre><code>## [1] 117
</code></pre>

<pre><code class="r">means
</code></pre>

<pre><code>##   [1]      NaN      NaN -23452.0 -20476.0 -14142.0 -14613.0  -5269.0
##   [8]   8109.0  12516.0      NaN      NaN      NaN -21729.0 -15620.7
##  [15] -13736.0 -10464.0  -8437.0  -5380.3  -2904.0   5717.1      NaN
##  [22]      NaN      NaN      NaN -15879.0 -10457.8 -10067.0  -4855.8
##  [29]  -3886.0   1245.5   1078.0   5818.8   6623.0  -7029.0 -14979.0
##  [36]   2144.9  -6019.0  -3924.0   -425.0   2276.0   4825.0      NaN
##  [43]      NaN      NaN      NaN      NaN      NaN -12204.0 -10132.0
##  [50] -10385.0 -10586.7  -5231.0  -7040.8   -805.0  -4093.7   2469.0
##  [57]   5835.0   5036.0      NaN  -7672.0  -6214.0  -4062.0   -713.0
##  [64]   2886.0  -7845.0 -10469.0  -6627.4  -5577.0   -598.8   2946.0
##  [71]  -8187.0  -6421.0  -3721.0  -2016.0   -815.0  -9526.0  -8405.0
##  [78]  -5365.0  -4438.0  -3041.0   -853.0    862.0   2930.0      NaN
##  [85]      NaN      NaN      NaN      NaN      NaN      NaN  -3333.0
##  [92]  -7055.0   -855.0  -7399.0   2491.8    116.8    730.8   2005.4
##  [99]  -5585.6  -6786.4  -2189.6  -4166.2   -135.8  -7512.0   1484.4
## [106]  -4110.0   -620.0    831.0    263.0   1233.8   1988.9   -732.0
## [113]  -6083.0  -2804.8  -1352.0   -724.0   -531.0
</code></pre>

<pre><code class="r">means[116]
</code></pre>

<pre><code>## [1] -724
</code></pre>

<pre><code class="r">i_good_NO_unknows = which(means != &quot;NaN&quot;)
means &lt;- means[i_good_NO_unknows]
print(&quot;De nuevo..&quot;)
</code></pre>

<pre><code>## [1] &quot;De nuevo..&quot;
</code></pre>

<pre><code class="r">length(means)
</code></pre>

<pre><code>## [1] 94
</code></pre>

<pre><code class="r">means
</code></pre>

<pre><code>##  [1] -23452.0 -20476.0 -14142.0 -14613.0  -5269.0   8109.0  12516.0
##  [8] -21729.0 -15620.7 -13736.0 -10464.0  -8437.0  -5380.3  -2904.0
## [15]   5717.1 -15879.0 -10457.8 -10067.0  -4855.8  -3886.0   1245.5
## [22]   1078.0   5818.8   6623.0  -7029.0 -14979.0   2144.9  -6019.0
## [29]  -3924.0   -425.0   2276.0   4825.0 -12204.0 -10132.0 -10385.0
## [36] -10586.7  -5231.0  -7040.8   -805.0  -4093.7   2469.0   5835.0
## [43]   5036.0  -7672.0  -6214.0  -4062.0   -713.0   2886.0  -7845.0
## [50] -10469.0  -6627.4  -5577.0   -598.8   2946.0  -8187.0  -6421.0
## [57]  -3721.0  -2016.0   -815.0  -9526.0  -8405.0  -5365.0  -4438.0
## [64]  -3041.0   -853.0    862.0   2930.0  -3333.0  -7055.0   -855.0
## [71]  -7399.0   2491.8    116.8    730.8   2005.4  -5585.6  -6786.4
## [78]  -2189.6  -4166.2   -135.8  -7512.0   1484.4  -4110.0   -620.0
## [85]    831.0    263.0   1233.8   1988.9   -732.0  -6083.0  -2804.8
## [92]  -1352.0   -724.0   -531.0
</code></pre>

<pre><code class="r">means[length(means)]
</code></pre>

<pre><code>## [1] -531
</code></pre>

<pre><code class="r">

### para ploteo..
min1 &lt;- min(means) - 1000
min1
</code></pre>

<pre><code>## [1] -24452
</code></pre>

<pre><code class="r">max1 &lt;- max(means) + 1000
max1
</code></pre>

<pre><code>## [1] 13516
</code></pre>

<pre><code class="r">step &lt;- (max1 - min1)/length(means)
xtitle1 &lt;- expression(paste(&quot;Outflow Velocity (&quot;, km, &quot; &quot;, s^-1, &quot;)&quot;))
### ylim=c(0.,0.0002), hist(means, seq(min1, max1, step), The
### Freedman-Diaconis rule is very robust and works well in practice. The
### bin-width is set to h=2???IQR???n???1/3. So the number of bins is (max-min)/h.
### hist(means,breaks=&#39;FD&#39;,

# hist(means,seq(min1, max1, step), prob=TRUE, xlab=xtitle1,
# ylim=c(0.,0.00018), col=&#39;grey&#39;, cex.axis=1.3, cex.lab=1.4,
# xlim=c(-25000.,8500),main =&#39;&#39;)

### La densidad promedio!!
coly1 = 1

## Para ver la informacion de los bandwidths
print(&quot;Info Density BW&quot;)
</code></pre>

<pre><code>## [1] &quot;Info Density BW&quot;
</code></pre>

<pre><code class="r">dw &lt;- density(means, bw = 100)
dw1 &lt;- density(means, bw = 500)
dw2 &lt;- density(means, bw = 1000)
dw3 &lt;- density(means, bw = 1500)

utils::str(dw)  ## 
</code></pre>

<pre><code>## List of 7
##  $ x        : num [1:512] -23752 -23680 -23609 -23537 -23466 ...
##  $ y        : num [1:512] 1.08e-06 4.88e-06 1.43e-05 2.81e-05 3.73e-05 ...
##  $ bw       : num 100
##  $ n        : int 94
##  $ call     : language density.default(x = means, bw = 100)
##  $ data.name: chr &quot;means&quot;
##  $ has.na   : logi FALSE
##  - attr(*, &quot;class&quot;)= chr &quot;density&quot;
</code></pre>

<pre><code class="r">#################################### Para la interpolacion..
f_inter_dw &lt;- approxfun(dw$x, dw$y)
#################################### 

### Para extraer los valores del histograma!!
mydata_hist &lt;- hist(means, seq(min1, max1, step), prob = TRUE, plot = FALSE)
</code></pre>

<pre><code>## Warning: argument &#39;probability&#39; is not made use of
</code></pre>

<pre><code class="r">## mydata_hist$count

utils::str(mydata_hist)  ## 
</code></pre>

<pre><code>## List of 6
##  $ breaks  : num [1:95] -24452 -24048 -23644 -23240 -22836 ...
##  $ counts  : int [1:94] 0 0 1 0 0 0 1 0 0 1 ...
##  $ density : num [1:94] 0.00 0.00 2.63e-05 0.00 0.00 ...
##  $ mids    : num [1:94] -24250 -23846 -23442 -23038 -22634 ...
##  $ xname   : chr &quot;means&quot;
##  $ equidist: logi TRUE
##  - attr(*, &quot;class&quot;)= chr &quot;histogram&quot;
</code></pre>

<pre><code class="r">
#################################### Para la interpolacion..
f_inter_dat &lt;- approxfun(mydata_hist$mids, mydata_hist$density)
#################################### 

### Finalmente cosntruyo el chisq.. f_inter_dat(dw$x) print(&#39;Separa --&#39;) dw$y
i_chisq0 &lt;- which(f_inter_dat(dw$x) != &quot;NA&quot;)
i_chisq1 &lt;- which(f_inter_dat(dw1$x) != &quot;NA&quot;)
i_chisq2 &lt;- which(f_inter_dat(dw2$x) != &quot;NA&quot;)
i_chisq3 &lt;- which(f_inter_dat(dw3$x) != &quot;NA&quot;)

### 
chisq0 = sum((f_inter_dat(dw$x[i_chisq0]) - dw$y[i_chisq0])^2)
chisq1 = sum((f_inter_dat(dw1$x[i_chisq1]) - dw1$y[i_chisq1])^2)
chisq2 = sum((f_inter_dat(dw2$x[i_chisq2]) - dw2$y[i_chisq2])^2)
chisq3 = sum((f_inter_dat(dw3$x[i_chisq3]) - dw3$y[i_chisq3])^2)

### Imprimo..
chisq0
</code></pre>

<pre><code>## [1] 1.462e-07
</code></pre>

<pre><code class="r">chisq1
</code></pre>

<pre><code>## [1] 1.417e-07
</code></pre>

<pre><code class="r">chisq2
</code></pre>

<pre><code>## [1] 2.227e-07
</code></pre>

<pre><code class="r">chisq3
</code></pre>

<pre><code>## [1] 2.367e-07
</code></pre>

<pre><code class="r">

## interpolo..  yinter1=f_inter(vel[j])

# lines(density(means, bw=&#39;SJ&#39;, adjust=1/6),col=coly1,lwd=5)
# lines(dw1,col=coly1,lwd=5) rug(means)


################################################################################ Data 2 -- with f errors Todo en vel2
arr1 = c(1, 2, 3, 4, 5, 6, 7, 8, 9, 10)
count = 1
for (i in arr1) {
    myfile_rd &lt;- paste(&quot;../Log1.15_Nvar_ID_smart_v2_WITH_f_ERRORS_20percent/ids&quot;, 
        as.character(i), &quot;/ID_lines.txt&quot;, sep = &quot;&quot;, collapse = NULL)
    ## 
    myfile_rd

    vel2 &lt;- read.table(myfile_rd, header = F)
    vel2
    ## Luego las cantidades..
    x &lt;- vel2[, 4]
    # i_good_NO_unknows=which(x!=0) x &lt;- x[i_good_NO_unknows]

    sims[, count] = x
    # print(sims)

    ### lines(density(x, bw=&#39;SJ&#39;, adjust=1/6),col=coly1,lwd=5)
    count = count + 1
    ################################################################################ 
}
sims[sims == 0] &lt;- NA
means &lt;- rowMeans(sims, na.rm = TRUE)
length(means)
</code></pre>

<pre><code>## [1] 117
</code></pre>

<pre><code class="r">means
</code></pre>

<pre><code>##   [1]      NaN      NaN -25331.0 -20476.0 -16084.0 -14613.0  -7271.0
##   [8]   8109.0  12516.0      NaN      NaN      NaN -21729.0 -15620.7
##  [15] -13736.0 -10464.0  -8437.0  -5380.3  -2904.0   5717.1      NaN
##  [22]      NaN      NaN      NaN -13844.2  -9373.6  -7990.2  -3750.5
##  [29]  -1765.8   2373.4   3234.2   6505.5   6623.0  -7029.0 -14979.0
##  [36]  -8368.0  -6019.0  -3924.0   -425.0   2276.0   4825.0      NaN
##  [43]      NaN      NaN      NaN      NaN      NaN -12204.0 -10132.0
##  [50] -10385.0 -10586.7  -5231.0  -7040.8   -805.0  -4093.7   2469.0
##  [57]   5835.0   4450.0      NaN  -7672.0  -6214.0  -4062.0   -713.0
##  [64]   2886.0  -7845.0 -10469.0  -6627.4  -5577.0   -598.8   2946.0
##  [71]  -8187.0  -6421.0  -3721.0  -2016.0   -815.0  -9526.0  -8405.0
##  [78]  -5365.0  -4438.0  -3041.0   -853.0    862.0   2930.0      NaN
##  [85]      NaN      NaN      NaN      NaN      NaN      NaN  -3333.0
##  [92]  -7055.0   -855.0  -7399.0   2491.8    116.8    730.8   2005.4
##  [99]  -5585.6  -6786.4  -2189.6  -4166.2   -135.8  -7512.0   1484.4
## [106]  -4110.0   -620.0    831.0    263.0   1233.8   1988.9   -732.0
## [113]  -6083.0  -2804.8  -1352.0   -724.0   -531.0
</code></pre>

<pre><code class="r">means[116]
</code></pre>

<pre><code>## [1] -724
</code></pre>

<pre><code class="r">i_good_NO_unknows = which(means != &quot;NaN&quot;)
means &lt;- means[i_good_NO_unknows]
print(&quot;De nuevo..&quot;)
</code></pre>

<pre><code>## [1] &quot;De nuevo..&quot;
</code></pre>

<pre><code class="r">length(means)
</code></pre>

<pre><code>## [1] 94
</code></pre>

<pre><code class="r">means
</code></pre>

<pre><code>##  [1] -25331.0 -20476.0 -16084.0 -14613.0  -7271.0   8109.0  12516.0
##  [8] -21729.0 -15620.7 -13736.0 -10464.0  -8437.0  -5380.3  -2904.0
## [15]   5717.1 -13844.2  -9373.6  -7990.2  -3750.5  -1765.8   2373.4
## [22]   3234.2   6505.5   6623.0  -7029.0 -14979.0  -8368.0  -6019.0
## [29]  -3924.0   -425.0   2276.0   4825.0 -12204.0 -10132.0 -10385.0
## [36] -10586.7  -5231.0  -7040.8   -805.0  -4093.7   2469.0   5835.0
## [43]   4450.0  -7672.0  -6214.0  -4062.0   -713.0   2886.0  -7845.0
## [50] -10469.0  -6627.4  -5577.0   -598.8   2946.0  -8187.0  -6421.0
## [57]  -3721.0  -2016.0   -815.0  -9526.0  -8405.0  -5365.0  -4438.0
## [64]  -3041.0   -853.0    862.0   2930.0  -3333.0  -7055.0   -855.0
## [71]  -7399.0   2491.8    116.8    730.8   2005.4  -5585.6  -6786.4
## [78]  -2189.6  -4166.2   -135.8  -7512.0   1484.4  -4110.0   -620.0
## [85]    831.0    263.0   1233.8   1988.9   -732.0  -6083.0  -2804.8
## [92]  -1352.0   -724.0   -531.0
</code></pre>

<pre><code class="r">means[length(means)]
</code></pre>

<pre><code>## [1] -531
</code></pre>

<pre><code class="r">
### para ploteo..  La densidad promedio!! coly1=4

### para ploteo..
min1 &lt;- min(means) - 1000
min1
</code></pre>

<pre><code>## [1] -26331
</code></pre>

<pre><code class="r">max1 &lt;- max(means) + 1000
max1
</code></pre>

<pre><code>## [1] 13516
</code></pre>

<pre><code class="r">step &lt;- (max1 - min1)/length(means)

## Para ver la informacion de los bandwidths
print(&quot;Info Density BW&quot;)
</code></pre>

<pre><code>## [1] &quot;Info Density BW&quot;
</code></pre>

<pre><code class="r">dw &lt;- density(means, bw = 100)
dw1 &lt;- density(means, bw = 500)
dw2 &lt;- density(means, bw = 1000)
dw3 &lt;- density(means, bw = 1500)

utils::str(dw)  ## 
</code></pre>

<pre><code>## List of 7
##  $ x        : num [1:512] -25631 -25556 -25481 -25405 -25330 ...
##  $ y        : num [1:512] 8.33e-07 4.43e-06 1.49e-05 3.12e-05 4.01e-05 ...
##  $ bw       : num 100
##  $ n        : int 94
##  $ call     : language density.default(x = means, bw = 100)
##  $ data.name: chr &quot;means&quot;
##  $ has.na   : logi FALSE
##  - attr(*, &quot;class&quot;)= chr &quot;density&quot;
</code></pre>

<pre><code class="r">#################################### Para la interpolacion..
f_inter_dw &lt;- approxfun(dw$x, dw$y)
#################################### 

### Para extraer los valores del histograma!!
mydata_hist &lt;- hist(means, seq(min1, max1, step), prob = TRUE, plot = FALSE)
</code></pre>

<pre><code>## Warning: argument &#39;probability&#39; is not made use of
</code></pre>

<pre><code class="r">## mydata_hist$count

utils::str(mydata_hist)  ## 
</code></pre>

<pre><code>## List of 6
##  $ breaks  : num [1:95] -26331 -25907 -25483 -25059 -24635 ...
##  $ counts  : int [1:94] 0 0 1 0 0 0 0 0 0 0 ...
##  $ density : num [1:94] 0.00 0.00 2.51e-05 0.00 0.00 ...
##  $ mids    : num [1:94] -26119 -25695 -25271 -24847 -24423 ...
##  $ xname   : chr &quot;means&quot;
##  $ equidist: logi TRUE
##  - attr(*, &quot;class&quot;)= chr &quot;histogram&quot;
</code></pre>

<pre><code class="r">
#################################### Para la interpolacion..
f_inter_dat &lt;- approxfun(mydata_hist$mids, mydata_hist$density)
#################################### 

### Finalmente cosntruyo el chisq.. f_inter_dat(dw$x) print(&#39;Separa --&#39;) dw$y
i_chisq0 &lt;- which(f_inter_dat(dw$x) != &quot;NA&quot;)
i_chisq1 &lt;- which(f_inter_dat(dw1$x) != &quot;NA&quot;)
i_chisq2 &lt;- which(f_inter_dat(dw2$x) != &quot;NA&quot;)
i_chisq3 &lt;- which(f_inter_dat(dw3$x) != &quot;NA&quot;)

### 
chisq0 = sum((f_inter_dat(dw$x[i_chisq0]) - dw$y[i_chisq0])^2)
chisq1 = sum((f_inter_dat(dw1$x[i_chisq1]) - dw1$y[i_chisq1])^2)
chisq2 = sum((f_inter_dat(dw2$x[i_chisq2]) - dw2$y[i_chisq2])^2)
chisq3 = sum((f_inter_dat(dw3$x[i_chisq3]) - dw3$y[i_chisq3])^2)

### Imprimo..
chisq0
</code></pre>

<pre><code>## [1] 1.113e-07
</code></pre>

<pre><code class="r">chisq1
</code></pre>

<pre><code>## [1] 1.479e-07
</code></pre>

<pre><code class="r">chisq2
</code></pre>

<pre><code>## [1] 2.109e-07
</code></pre>

<pre><code class="r">chisq3
</code></pre>

<pre><code>## [1] 2.234e-07
</code></pre>

<pre><code class="r">

## interpolo..  yinter1=f_inter(vel[j])

# lines(density(means, bw=&#39;SJ&#39;, adjust=1/6),col=coly1,lwd=5)

## Los errores de otra linea!!
typ1 = 2

# lines(dw1,col=coly1,lwd=5,lty=typ1)


################################################################################ Data 3 Todo en vel2
arr1 = c(1, 2, 3, 4, 5, 6, 7, 8, 9, 10)
count = 1
for (i in arr1) {
    myfile_rd &lt;- paste(&quot;../Log2.08_Nvar_ID_smart_v2/ids&quot;, as.character(i), &quot;/ID_lines.txt&quot;, 
        sep = &quot;&quot;, collapse = NULL)
    ## 
    myfile_rd

    vel2 &lt;- read.table(myfile_rd, header = F)
    vel2
    ## Luego las cantidades..
    x &lt;- vel2[, 4]
    # i_good_NO_unknows=which(x!=0) x &lt;- x[i_good_NO_unknows]

    sims[, count] = x
    # print(sims)

    ### lines(density(x, bw=&#39;SJ&#39;, adjust=1/6),col=coly1,lwd=5)
    count = count + 1
    ################################################################################ 
}

########################## Data global!! ########
count_global = 2
means_for_global &lt;- rowMeans(sims, na.rm = FALSE)
sims_global[, count_global] &lt;- means_for_global
########################## 



sims[sims == 0] &lt;- NA
means &lt;- rowMeans(sims, na.rm = TRUE)
length(means)
</code></pre>

<pre><code>## [1] 117
</code></pre>

<pre><code class="r">means
</code></pre>

<pre><code>##   [1]  17069.0 -25965.0 -14135.7 -14131.0  -4511.9  -8134.0   4660.2
##   [8]   -578.0 -20831.1 -21838.0  -8639.7 -19013.0 -11066.0  -1502.8
##  [15]  -2766.0   3910.7   2736.0   9247.3   8482.0 -14598.0   -805.0
##  [22]   3052.0  -7053.0 -14313.3   -654.0  -3105.0   5470.0   2639.0
##  [29]   8128.7  -5032.1   7590.0   -554.6 -10669.6   6576.3 -14979.0
##  [36]   6350.0  -6019.0  -3924.0   -425.0   2276.0   4825.0 -12053.0
##  [43] -10853.4  -4398.0  -1743.7   4843.0 -11764.0 -12204.0 -10132.0
##  [50]  -3541.0  -4480.5   1734.0   -860.4   6265.0   2149.3  -8550.2
##  [57]  -8394.9  -1151.8  -5653.0  -7672.0    208.0  -4062.0   5829.0
##  [64]   2886.0  -8470.3  -4632.6  -9869.9   -724.3  -6743.7  -6232.3
##  [71]  -6274.2  -3044.1  -1778.5    964.8    -25.7  -9526.0  -8143.0
##  [78]  -5365.0  -4172.0  -3041.0   -584.0    862.0   3202.0   3508.0
##  [85]  -6402.0  -4954.0  -2360.0   -890.0   1939.0   4072.0  -4698.6
##  [92]  -3188.8  -2232.6    -68.9   -113.9  -1606.0   -656.0    624.0
##  [99]   2914.0   -662.0  -5156.5   2012.6  -3683.8  -4150.0  -4808.0
## [106]   -709.0   -620.0   -633.0   -861.9  -3032.0   1885.9   -732.0
## [113]  -6083.0  -3304.0  -1352.0   -724.0   -531.0
</code></pre>

<pre><code class="r">means[116]
</code></pre>

<pre><code>## [1] -724
</code></pre>

<pre><code class="r">i_good_NO_unknows = which(means != &quot;NaN&quot;)
means &lt;- means[i_good_NO_unknows]
print(&quot;De nuevo..&quot;)
</code></pre>

<pre><code>## [1] &quot;De nuevo..&quot;
</code></pre>

<pre><code class="r">length(means)
</code></pre>

<pre><code>## [1] 117
</code></pre>

<pre><code class="r">means
</code></pre>

<pre><code>##   [1]  17069.0 -25965.0 -14135.7 -14131.0  -4511.9  -8134.0   4660.2
##   [8]   -578.0 -20831.1 -21838.0  -8639.7 -19013.0 -11066.0  -1502.8
##  [15]  -2766.0   3910.7   2736.0   9247.3   8482.0 -14598.0   -805.0
##  [22]   3052.0  -7053.0 -14313.3   -654.0  -3105.0   5470.0   2639.0
##  [29]   8128.7  -5032.1   7590.0   -554.6 -10669.6   6576.3 -14979.0
##  [36]   6350.0  -6019.0  -3924.0   -425.0   2276.0   4825.0 -12053.0
##  [43] -10853.4  -4398.0  -1743.7   4843.0 -11764.0 -12204.0 -10132.0
##  [50]  -3541.0  -4480.5   1734.0   -860.4   6265.0   2149.3  -8550.2
##  [57]  -8394.9  -1151.8  -5653.0  -7672.0    208.0  -4062.0   5829.0
##  [64]   2886.0  -8470.3  -4632.6  -9869.9   -724.3  -6743.7  -6232.3
##  [71]  -6274.2  -3044.1  -1778.5    964.8    -25.7  -9526.0  -8143.0
##  [78]  -5365.0  -4172.0  -3041.0   -584.0    862.0   3202.0   3508.0
##  [85]  -6402.0  -4954.0  -2360.0   -890.0   1939.0   4072.0  -4698.6
##  [92]  -3188.8  -2232.6    -68.9   -113.9  -1606.0   -656.0    624.0
##  [99]   2914.0   -662.0  -5156.5   2012.6  -3683.8  -4150.0  -4808.0
## [106]   -709.0   -620.0   -633.0   -861.9  -3032.0   1885.9   -732.0
## [113]  -6083.0  -3304.0  -1352.0   -724.0   -531.0
</code></pre>

<pre><code class="r">means[length(means)]
</code></pre>

<pre><code>## [1] -531
</code></pre>

<pre><code class="r">
### para ploteo..  La densidad promedio!!
coly1 = 2

### para ploteo..
min1 &lt;- min(means) - 1000
min1
</code></pre>

<pre><code>## [1] -26965
</code></pre>

<pre><code class="r">max1 &lt;- max(means) + 1000
max1
</code></pre>

<pre><code>## [1] 18069
</code></pre>

<pre><code class="r">step &lt;- (max1 - min1)/length(means)

## Para ver la informacion de los bandwidths
print(&quot;Info Density BW&quot;)
</code></pre>

<pre><code>## [1] &quot;Info Density BW&quot;
</code></pre>

<pre><code class="r">dw &lt;- density(means, bw = 100)
dw1 &lt;- density(means, bw = 500)
dw2 &lt;- density(means, bw = 1000)
dw3 &lt;- density(means, bw = 1500)

utils::str(dw)  ## 
</code></pre>

<pre><code>## List of 7
##  $ x        : num [1:512] -26265 -26180 -26094 -26009 -25923 ...
##  $ y        : num [1:512] 6.85e-07 4.66e-06 1.59e-05 2.86e-05 2.85e-05 ...
##  $ bw       : num 100
##  $ n        : int 117
##  $ call     : language density.default(x = means, bw = 100)
##  $ data.name: chr &quot;means&quot;
##  $ has.na   : logi FALSE
##  - attr(*, &quot;class&quot;)= chr &quot;density&quot;
</code></pre>

<pre><code class="r">#################################### Para la interpolacion..
f_inter_dw &lt;- approxfun(dw$x, dw$y)
#################################### 

### Para extraer los valores del histograma!!
mydata_hist &lt;- hist(means, seq(min1, max1, step), prob = TRUE, plot = FALSE)
</code></pre>

<pre><code>## Warning: argument &#39;probability&#39; is not made use of
</code></pre>

<pre><code class="r">## mydata_hist$count

utils::str(mydata_hist)  ## 
</code></pre>

<pre><code>## List of 6
##  $ breaks  : num [1:118] -26965 -26580 -26195 -25810 -25425 ...
##  $ counts  : int [1:117] 0 0 1 0 0 0 0 0 0 0 ...
##  $ density : num [1:117] 0.00 0.00 2.22e-05 0.00 0.00 ...
##  $ mids    : num [1:117] -26773 -26388 -26003 -25618 -25233 ...
##  $ xname   : chr &quot;means&quot;
##  $ equidist: logi TRUE
##  - attr(*, &quot;class&quot;)= chr &quot;histogram&quot;
</code></pre>

<pre><code class="r">
#################################### Para la interpolacion..
f_inter_dat &lt;- approxfun(mydata_hist$mids, mydata_hist$density)
#################################### 

### Finalmente cosntruyo el chisq.. f_inter_dat(dw$x) print(&#39;Separa --&#39;) dw$y
i_chisq0 &lt;- which(f_inter_dat(dw$x) != &quot;NA&quot;)
i_chisq1 &lt;- which(f_inter_dat(dw1$x) != &quot;NA&quot;)
i_chisq2 &lt;- which(f_inter_dat(dw2$x) != &quot;NA&quot;)
i_chisq3 &lt;- which(f_inter_dat(dw3$x) != &quot;NA&quot;)

### 
chisq0 = sum((f_inter_dat(dw$x[i_chisq0]) - dw$y[i_chisq0])^2)
chisq1 = sum((f_inter_dat(dw1$x[i_chisq1]) - dw1$y[i_chisq1])^2)
chisq2 = sum((f_inter_dat(dw2$x[i_chisq2]) - dw2$y[i_chisq2])^2)
chisq3 = sum((f_inter_dat(dw3$x[i_chisq3]) - dw3$y[i_chisq3])^2)

### Imprimo..
chisq0
</code></pre>

<pre><code>## [1] 9.457e-08
</code></pre>

<pre><code class="r">chisq1
</code></pre>

<pre><code>## [1] 1.333e-07
</code></pre>

<pre><code class="r">chisq2
</code></pre>

<pre><code>## [1] 2.231e-07
</code></pre>

<pre><code class="r">chisq3
</code></pre>

<pre><code>## [1] 2.469e-07
</code></pre>

<pre><code class="r">

## interpolo..  yinter1=f_inter(vel[j])

# lines(density(means, bw=&#39;SJ&#39;, adjust=1/6),col=coly1,lwd=5)
# lines(dw1,col=coly1,lwd=5)

################################################################################ Data 3 -- with f errors Todo en vel2
arr1 = c(1, 2, 3, 4, 5, 6, 7, 8, 9, 10)
count = 1
for (i in arr1) {
    myfile_rd &lt;- paste(&quot;../Log2.08_Nvar_ID_smart_v2_WITH_f_ERRORS_20percent/ids&quot;, 
        as.character(i), &quot;/ID_lines.txt&quot;, sep = &quot;&quot;, collapse = NULL)
    ## 
    myfile_rd

    vel2 &lt;- read.table(myfile_rd, header = F)
    vel2
    ## Luego las cantidades..
    x &lt;- vel2[, 4]
    # i_good_NO_unknows=which(x!=0) x &lt;- x[i_good_NO_unknows]

    sims[, count] = x
    # print(sims)

    ### lines(density(x, bw=&#39;SJ&#39;, adjust=1/6),col=coly1,lwd=5)
    count = count + 1
    ################################################################################ 
}
sims[sims == 0] &lt;- NA
means &lt;- rowMeans(sims, na.rm = TRUE)
length(means)
</code></pre>

<pre><code>## [1] 117
</code></pre>

<pre><code class="r">means
</code></pre>

<pre><code>##   [1]  17069.0 -25965.0 -14135.7 -14131.0 -17753.2  -8134.0  -8992.4
##   [8]   8143.3  -2429.8 -13308.0 -17223.7 -19013.0 -11066.0  -2614.2
##  [15]  -2766.0   2779.1   2736.0   8095.8   8482.0 -14598.0   -805.0
##  [22]   3052.0  -7053.0 -14313.3   -654.0  -3105.0   5470.0   2639.0
##  [29]   8128.7  -4172.0   7243.5   -285.9 -10669.6   8088.0 -14979.0
##  [36]   6350.0  -6019.0  -3924.0   -425.0   2276.0   4825.0 -12053.0
##  [43] -10736.8  -4398.0  -1623.4   4843.0 -11926.4 -12204.0 -10132.0
##  [50]  -3541.0  -4480.5   1734.0   -860.4   6265.0   2149.3  -8550.2
##  [57]  -5343.9  -1210.4  -2556.4  -7672.0   3366.4  -4062.0   3039.4
##  [64]   2886.0  -8443.1  -4632.6  -9869.9   -724.3  -6743.7  -6232.3
##  [71]  -6005.6  -3044.1  -1505.7    690.4    249.7  -9526.0  -8143.0
##  [78]  -5365.0  -4172.0  -3041.0   -584.0    862.0   3202.0   3508.0
##  [85]  -6822.0  -4954.0  -2786.0   -890.0   1507.0   4072.0  -4698.6
##  [92]  -3188.8  -2232.6    -68.9   -113.9  -1606.0   -656.0    624.0
##  [99]   2914.0   -662.0  -5156.5   2012.6  -3683.8  -4150.0  -4808.0
## [106]   -709.0   -620.0   -633.0   -861.9  -3032.0   1885.9   -732.0
## [113]  -5543.9  -3054.4  -1352.0   -724.0   -531.0
</code></pre>

<pre><code class="r">means[116]
</code></pre>

<pre><code>## [1] -724
</code></pre>

<pre><code class="r">i_good_NO_unknows = which(means != &quot;NaN&quot;)
means &lt;- means[i_good_NO_unknows]
print(&quot;De nuevo..&quot;)
</code></pre>

<pre><code>## [1] &quot;De nuevo..&quot;
</code></pre>

<pre><code class="r">length(means)
</code></pre>

<pre><code>## [1] 117
</code></pre>

<pre><code class="r">means
</code></pre>

<pre><code>##   [1]  17069.0 -25965.0 -14135.7 -14131.0 -17753.2  -8134.0  -8992.4
##   [8]   8143.3  -2429.8 -13308.0 -17223.7 -19013.0 -11066.0  -2614.2
##  [15]  -2766.0   2779.1   2736.0   8095.8   8482.0 -14598.0   -805.0
##  [22]   3052.0  -7053.0 -14313.3   -654.0  -3105.0   5470.0   2639.0
##  [29]   8128.7  -4172.0   7243.5   -285.9 -10669.6   8088.0 -14979.0
##  [36]   6350.0  -6019.0  -3924.0   -425.0   2276.0   4825.0 -12053.0
##  [43] -10736.8  -4398.0  -1623.4   4843.0 -11926.4 -12204.0 -10132.0
##  [50]  -3541.0  -4480.5   1734.0   -860.4   6265.0   2149.3  -8550.2
##  [57]  -5343.9  -1210.4  -2556.4  -7672.0   3366.4  -4062.0   3039.4
##  [64]   2886.0  -8443.1  -4632.6  -9869.9   -724.3  -6743.7  -6232.3
##  [71]  -6005.6  -3044.1  -1505.7    690.4    249.7  -9526.0  -8143.0
##  [78]  -5365.0  -4172.0  -3041.0   -584.0    862.0   3202.0   3508.0
##  [85]  -6822.0  -4954.0  -2786.0   -890.0   1507.0   4072.0  -4698.6
##  [92]  -3188.8  -2232.6    -68.9   -113.9  -1606.0   -656.0    624.0
##  [99]   2914.0   -662.0  -5156.5   2012.6  -3683.8  -4150.0  -4808.0
## [106]   -709.0   -620.0   -633.0   -861.9  -3032.0   1885.9   -732.0
## [113]  -5543.9  -3054.4  -1352.0   -724.0   -531.0
</code></pre>

<pre><code class="r">means[length(means)]
</code></pre>

<pre><code>## [1] -531
</code></pre>

<pre><code class="r">
### para ploteo..  La densidad promedio!! coly1=4

### para ploteo..
min1 &lt;- min(means) - 1000
min1
</code></pre>

<pre><code>## [1] -26965
</code></pre>

<pre><code class="r">max1 &lt;- max(means) + 1000
max1
</code></pre>

<pre><code>## [1] 18069
</code></pre>

<pre><code class="r">step &lt;- (max1 - min1)/length(means)

## Para ver la informacion de los bandwidths
print(&quot;Info Density BW&quot;)
</code></pre>

<pre><code>## [1] &quot;Info Density BW&quot;
</code></pre>

<pre><code class="r">dw &lt;- density(means, bw = 100)
dw1 &lt;- density(means, bw = 500)
dw2 &lt;- density(means, bw = 1000)
dw3 &lt;- density(means, bw = 1500)

utils::str(dw)  ## 
</code></pre>

<pre><code>## List of 7
##  $ x        : num [1:512] -26265 -26180 -26094 -26009 -25923 ...
##  $ y        : num [1:512] 6.85e-07 4.66e-06 1.59e-05 2.86e-05 2.85e-05 ...
##  $ bw       : num 100
##  $ n        : int 117
##  $ call     : language density.default(x = means, bw = 100)
##  $ data.name: chr &quot;means&quot;
##  $ has.na   : logi FALSE
##  - attr(*, &quot;class&quot;)= chr &quot;density&quot;
</code></pre>

<pre><code class="r">#################################### Para la interpolacion..
f_inter_dw &lt;- approxfun(dw$x, dw$y)
#################################### 

### Para extraer los valores del histograma!!
mydata_hist &lt;- hist(means, seq(min1, max1, step), prob = TRUE, plot = FALSE)
</code></pre>

<pre><code>## Warning: argument &#39;probability&#39; is not made use of
</code></pre>

<pre><code class="r">## mydata_hist$count

utils::str(mydata_hist)  ## 
</code></pre>

<pre><code>## List of 6
##  $ breaks  : num [1:118] -26965 -26580 -26195 -25810 -25425 ...
##  $ counts  : int [1:117] 0 0 1 0 0 0 0 0 0 0 ...
##  $ density : num [1:117] 0.00 0.00 2.22e-05 0.00 0.00 ...
##  $ mids    : num [1:117] -26773 -26388 -26003 -25618 -25233 ...
##  $ xname   : chr &quot;means&quot;
##  $ equidist: logi TRUE
##  - attr(*, &quot;class&quot;)= chr &quot;histogram&quot;
</code></pre>

<pre><code class="r">
#################################### Para la interpolacion..
f_inter_dat &lt;- approxfun(mydata_hist$mids, mydata_hist$density)
#################################### 

### Finalmente cosntruyo el chisq.. f_inter_dat(dw$x) print(&#39;Separa --&#39;) dw$y
i_chisq0 &lt;- which(f_inter_dat(dw$x) != &quot;NA&quot;)
i_chisq1 &lt;- which(f_inter_dat(dw1$x) != &quot;NA&quot;)
i_chisq2 &lt;- which(f_inter_dat(dw2$x) != &quot;NA&quot;)
i_chisq3 &lt;- which(f_inter_dat(dw3$x) != &quot;NA&quot;)

### 
chisq0 = sum((f_inter_dat(dw$x[i_chisq0]) - dw$y[i_chisq0])^2)
chisq1 = sum((f_inter_dat(dw1$x[i_chisq1]) - dw1$y[i_chisq1])^2)
chisq2 = sum((f_inter_dat(dw2$x[i_chisq2]) - dw2$y[i_chisq2])^2)
chisq3 = sum((f_inter_dat(dw3$x[i_chisq3]) - dw3$y[i_chisq3])^2)

### Imprimo..
chisq0
</code></pre>

<pre><code>## [1] 1.079e-07
</code></pre>

<pre><code class="r">chisq1
</code></pre>

<pre><code>## [1] 1.129e-07
</code></pre>

<pre><code class="r">chisq2
</code></pre>

<pre><code>## [1] 1.871e-07
</code></pre>

<pre><code class="r">chisq3
</code></pre>

<pre><code>## [1] 2.046e-07
</code></pre>

<pre><code class="r">

## interpolo..  yinter1=f_inter(vel[j])

# lines(density(means, bw=&#39;SJ&#39;, adjust=1/6),col=coly1,lwd=5)

## Los errores de otra linea!!
typ1 = 2

# lines(dw1,col=coly1,lwd=5,lty=typ1)

################################################################################ Data 4 Todo en vel2
arr1 = c(1, 2, 3, 4, 5, 6, 7, 8, 9, 10)
count = 1
for (i in arr1) {
    myfile_rd &lt;- paste(&quot;../Log2.83_Nvar_ID_smart_v2/ids&quot;, as.character(i), &quot;/ID_lines.txt&quot;, 
        sep = &quot;&quot;, collapse = NULL)
    ## 
    myfile_rd

    vel2 &lt;- read.table(myfile_rd, header = F)
    vel2
    ## Luego las cantidades..
    x &lt;- vel2[, 4]
    # i_good_NO_unknows=which(x!=0) x &lt;- x[i_good_NO_unknows]

    sims[, count] = x
    # print(sims)

    ### lines(density(x, bw=&#39;SJ&#39;, adjust=1/6),col=coly1,lwd=5)
    count = count + 1
    ################################################################################ 
}

########################## Data global!! ########
count_global = 3
means_for_global &lt;- rowMeans(sims, na.rm = FALSE)
sims_global[, count_global] &lt;- means_for_global
########################## 



sims[sims == 0] &lt;- NA
means &lt;- rowMeans(sims, na.rm = TRUE)
length(means)
</code></pre>

<pre><code>## [1] 117
</code></pre>

<pre><code class="r">means
</code></pre>

<pre><code>##   [1] -19600.0 -16520.0   7381.0  -4278.0  -4946.9   1925.0   4212.0
##   [8]   -578.0 -23898.0 -21838.0  -7209.0 -19013.0 -16080.0   -704.0
##  [15]  -7924.0   4724.0  -2517.0  10075.0   3128.0 -14598.0   -805.0
##  [22] -16175.0  -7053.0 -15200.0   -654.0 -16648.0   5470.0 -11166.0
##  [29]   7817.0  -5195.0  -5826.0   -720.0 -12549.0   8088.0   -552.0
##  [36] -13205.0 -14730.0  -8834.0  -9302.0 -14183.0  -1821.8 -12053.0
##  [43]  -5679.0  -4398.0   3594.0   4843.0  -8825.0   1273.5   -271.0
##  [50]  -3541.0 -10154.0   1734.0  -6603.0   6265.0  -3651.0  -8109.0
##  [57]  -9909.9  -6845.7  -5585.9   -669.1    276.4   3027.1   5174.8
##  [64]  -7917.0  -4641.0  -9863.0  -2792.4  -4960.0  -1172.0   3580.0
##  [71]  -5125.0  -4989.0  -9318.0   1111.0  -6467.0  -5540.8    617.0
##  [78]  -8923.0   4707.0  -6626.0   3251.2  -2770.0   1854.2   3056.0
##  [85]  -6402.0  -4954.0  -2360.0   -890.0   1939.0   4072.0  -5040.0
##  [92]  -3876.0  -2577.0   -385.0   -278.0  -1606.0   -656.0    624.0
##  [99]  -4309.2  -8062.0  -2168.5  -5453.0   -723.3  -7512.0   2271.0
## [106]  -4110.0   3285.0    831.0   2284.0  -3583.0  -6527.0   -294.0
## [113]  -6083.0   2974.0  -4188.0   -724.0   -531.0
</code></pre>

<pre><code class="r">means[116]
</code></pre>

<pre><code>## [1] -724
</code></pre>

<pre><code class="r">i_good_NO_unknows = which(means != &quot;NaN&quot;)
means &lt;- means[i_good_NO_unknows]
print(&quot;De nuevo..&quot;)
</code></pre>

<pre><code>## [1] &quot;De nuevo..&quot;
</code></pre>

<pre><code class="r">length(means)
</code></pre>

<pre><code>## [1] 117
</code></pre>

<pre><code class="r">means
</code></pre>

<pre><code>##   [1] -19600.0 -16520.0   7381.0  -4278.0  -4946.9   1925.0   4212.0
##   [8]   -578.0 -23898.0 -21838.0  -7209.0 -19013.0 -16080.0   -704.0
##  [15]  -7924.0   4724.0  -2517.0  10075.0   3128.0 -14598.0   -805.0
##  [22] -16175.0  -7053.0 -15200.0   -654.0 -16648.0   5470.0 -11166.0
##  [29]   7817.0  -5195.0  -5826.0   -720.0 -12549.0   8088.0   -552.0
##  [36] -13205.0 -14730.0  -8834.0  -9302.0 -14183.0  -1821.8 -12053.0
##  [43]  -5679.0  -4398.0   3594.0   4843.0  -8825.0   1273.5   -271.0
##  [50]  -3541.0 -10154.0   1734.0  -6603.0   6265.0  -3651.0  -8109.0
##  [57]  -9909.9  -6845.7  -5585.9   -669.1    276.4   3027.1   5174.8
##  [64]  -7917.0  -4641.0  -9863.0  -2792.4  -4960.0  -1172.0   3580.0
##  [71]  -5125.0  -4989.0  -9318.0   1111.0  -6467.0  -5540.8    617.0
##  [78]  -8923.0   4707.0  -6626.0   3251.2  -2770.0   1854.2   3056.0
##  [85]  -6402.0  -4954.0  -2360.0   -890.0   1939.0   4072.0  -5040.0
##  [92]  -3876.0  -2577.0   -385.0   -278.0  -1606.0   -656.0    624.0
##  [99]  -4309.2  -8062.0  -2168.5  -5453.0   -723.3  -7512.0   2271.0
## [106]  -4110.0   3285.0    831.0   2284.0  -3583.0  -6527.0   -294.0
## [113]  -6083.0   2974.0  -4188.0   -724.0   -531.0
</code></pre>

<pre><code class="r">means[length(means)]
</code></pre>

<pre><code>## [1] -531
</code></pre>

<pre><code class="r">
### para ploteo..  La densidad promedio!!
coly1 = 4

### para ploteo..
min1 &lt;- min(means) - 1000
min1
</code></pre>

<pre><code>## [1] -24898
</code></pre>

<pre><code class="r">max1 &lt;- max(means) + 1000
max1
</code></pre>

<pre><code>## [1] 11075
</code></pre>

<pre><code class="r">step &lt;- (max1 - min1)/length(means)

## Para ver la informacion de los bandwidths
print(&quot;Info Density BW&quot;)
</code></pre>

<pre><code>## [1] &quot;Info Density BW&quot;
</code></pre>

<pre><code class="r">dw &lt;- density(means, bw = 100)
dw1 &lt;- density(means, bw = 500)
dw2 &lt;- density(means, bw = 1000)
dw3 &lt;- density(means, bw = 1500)

utils::str(dw)  ## 
</code></pre>

<pre><code>## List of 7
##  $ x        : num [1:512] -24198 -24130 -24063 -23995 -23927 ...
##  $ y        : num [1:512] 5.38e-07 2.89e-06 9.82e-06 2.15e-05 3.08e-05 ...
##  $ bw       : num 100
##  $ n        : int 117
##  $ call     : language density.default(x = means, bw = 100)
##  $ data.name: chr &quot;means&quot;
##  $ has.na   : logi FALSE
##  - attr(*, &quot;class&quot;)= chr &quot;density&quot;
</code></pre>

<pre><code class="r">#################################### Para la interpolacion..
f_inter_dw &lt;- approxfun(dw$x, dw$y)
#################################### 

### Para extraer los valores del histograma!!
mydata_hist &lt;- hist(means, seq(min1, max1, step), prob = TRUE, plot = FALSE)
</code></pre>

<pre><code>## Warning: argument &#39;probability&#39; is not made use of
</code></pre>

<pre><code class="r">## mydata_hist$count

utils::str(mydata_hist)  ## 
</code></pre>

<pre><code>## List of 6
##  $ breaks  : num [1:118] -24898 -24591 -24283 -23976 -23668 ...
##  $ counts  : int [1:117] 0 0 0 1 0 0 0 0 0 1 ...
##  $ density : num [1:117] 0.00 0.00 0.00 2.78e-05 0.00 ...
##  $ mids    : num [1:117] -24744 -24437 -24129 -23822 -23514 ...
##  $ xname   : chr &quot;means&quot;
##  $ equidist: logi TRUE
##  - attr(*, &quot;class&quot;)= chr &quot;histogram&quot;
</code></pre>

<pre><code class="r">
#################################### Para la interpolacion..
f_inter_dat &lt;- approxfun(mydata_hist$mids, mydata_hist$density)
#################################### 

### Finalmente cosntruyo el chisq.. f_inter_dat(dw$x) print(&#39;Separa --&#39;) dw$y
i_chisq0 &lt;- which(f_inter_dat(dw$x) != &quot;NA&quot;)
i_chisq1 &lt;- which(f_inter_dat(dw1$x) != &quot;NA&quot;)
i_chisq2 &lt;- which(f_inter_dat(dw2$x) != &quot;NA&quot;)
i_chisq3 &lt;- which(f_inter_dat(dw3$x) != &quot;NA&quot;)

### 
chisq0 = sum((f_inter_dat(dw$x[i_chisq0]) - dw$y[i_chisq0])^2)
chisq1 = sum((f_inter_dat(dw1$x[i_chisq1]) - dw1$y[i_chisq1])^2)
chisq2 = sum((f_inter_dat(dw2$x[i_chisq2]) - dw2$y[i_chisq2])^2)
chisq3 = sum((f_inter_dat(dw3$x[i_chisq3]) - dw3$y[i_chisq3])^2)

### Imprimo..
chisq0
</code></pre>

<pre><code>## [1] 1.149e-07
</code></pre>

<pre><code class="r">chisq1
</code></pre>

<pre><code>## [1] 1.942e-07
</code></pre>

<pre><code class="r">chisq2
</code></pre>

<pre><code>## [1] 2.547e-07
</code></pre>

<pre><code class="r">chisq3
</code></pre>

<pre><code>## [1] 2.572e-07
</code></pre>

<pre><code class="r">

## interpolo..  yinter1=f_inter(vel[j])

# lines(density(means, bw=&#39;SJ&#39;, adjust=1/6),col=coly1,lwd=5)
# lines(dw1,col=coly1,lwd=5)


################################################################################ Data 4 -- with f errors Todo en vel2
arr1 = c(1, 2, 3, 4, 5, 6, 7, 8, 9, 10)
count = 1
for (i in arr1) {
    myfile_rd &lt;- paste(&quot;../Log2.83_Nvar_ID_smart_v2_WITH_f_ERRORS_20percent/ids&quot;, 
        as.character(i), &quot;/ID_lines.txt&quot;, sep = &quot;&quot;, collapse = NULL)
    ## 
    myfile_rd

    vel2 &lt;- read.table(myfile_rd, header = F)
    vel2
    ## Luego las cantidades..
    x &lt;- vel2[, 4]
    # i_good_NO_unknows=which(x!=0) x &lt;- x[i_good_NO_unknows]

    sims[, count] = x
    # print(sims)

    ### lines(density(x, bw=&#39;SJ&#39;, adjust=1/6),col=coly1,lwd=5)
    count = count + 1
    ################################################################################ 
}
sims[sims == 0] &lt;- NA
means &lt;- rowMeans(sims, na.rm = TRUE)
length(means)
</code></pre>

<pre><code>## [1] 117
</code></pre>

<pre><code class="r">means
</code></pre>

<pre><code>##   [1] -19600.0 -16520.0   7381.0  -4278.0  -2820.0   1925.0   6405.0
##   [8]   -578.0 -23898.0 -21838.0  -7209.0 -19013.0 -16080.0   -704.0
##  [15]  -7924.0   4724.0  -2517.0  10075.0   3128.0 -14598.0   -805.0
##  [22] -16175.0  -7053.0 -15200.0   -654.0 -16648.0   5470.0 -11166.0
##  [29]   7817.0  -5195.0  -5826.0   -720.0 -12549.0   8088.0   -552.0
##  [36] -13205.0 -14346.5  -8834.0  -8911.2 -14183.0  -1424.1 -12053.0
##  [43]  -5679.0  -4398.0   2638.2   4843.0  -7452.8   1886.9   -593.5
##  [50]  -2909.1 -10154.0   2045.7  -6603.0   4511.6  -3651.0  -8109.0
##  [57]  -9777.7  -5959.5  -5451.7   -669.1    413.2   3027.1   5174.8
##  [64]  -7917.0  -4641.0  -9863.0  -6090.6  -4960.0  -1172.0   3580.0
##  [71]  -5125.0  -4989.0  -9318.0   1111.0  -6467.0  -5674.0    617.0
##  [78]  -8923.0   4707.0  -6626.0   3114.0  -2770.0   2455.8   3056.0
##  [85]  -6528.0  -4954.0  -2487.8   -890.0   1809.4   4072.0  -5040.0
##  [92]  -3764.7  -2577.0   -272.4   -238.0  -1606.0   -656.0    624.0
##  [99]  -5212.1  -7137.0  -2168.5  -4519.8  -1051.1  -7512.0   2271.0
## [106]  -4110.0   3238.6    831.0   2284.0  -3583.0  -6527.0   -294.0
## [113]  -6083.0   2974.0  -4188.0   -724.0   -531.0
</code></pre>

<pre><code class="r">means[116]
</code></pre>

<pre><code>## [1] -724
</code></pre>

<pre><code class="r">i_good_NO_unknows = which(means != &quot;NaN&quot;)
means &lt;- means[i_good_NO_unknows]
print(&quot;De nuevo..&quot;)
</code></pre>

<pre><code>## [1] &quot;De nuevo..&quot;
</code></pre>

<pre><code class="r">length(means)
</code></pre>

<pre><code>## [1] 117
</code></pre>

<pre><code class="r">means
</code></pre>

<pre><code>##   [1] -19600.0 -16520.0   7381.0  -4278.0  -2820.0   1925.0   6405.0
##   [8]   -578.0 -23898.0 -21838.0  -7209.0 -19013.0 -16080.0   -704.0
##  [15]  -7924.0   4724.0  -2517.0  10075.0   3128.0 -14598.0   -805.0
##  [22] -16175.0  -7053.0 -15200.0   -654.0 -16648.0   5470.0 -11166.0
##  [29]   7817.0  -5195.0  -5826.0   -720.0 -12549.0   8088.0   -552.0
##  [36] -13205.0 -14346.5  -8834.0  -8911.2 -14183.0  -1424.1 -12053.0
##  [43]  -5679.0  -4398.0   2638.2   4843.0  -7452.8   1886.9   -593.5
##  [50]  -2909.1 -10154.0   2045.7  -6603.0   4511.6  -3651.0  -8109.0
##  [57]  -9777.7  -5959.5  -5451.7   -669.1    413.2   3027.1   5174.8
##  [64]  -7917.0  -4641.0  -9863.0  -6090.6  -4960.0  -1172.0   3580.0
##  [71]  -5125.0  -4989.0  -9318.0   1111.0  -6467.0  -5674.0    617.0
##  [78]  -8923.0   4707.0  -6626.0   3114.0  -2770.0   2455.8   3056.0
##  [85]  -6528.0  -4954.0  -2487.8   -890.0   1809.4   4072.0  -5040.0
##  [92]  -3764.7  -2577.0   -272.4   -238.0  -1606.0   -656.0    624.0
##  [99]  -5212.1  -7137.0  -2168.5  -4519.8  -1051.1  -7512.0   2271.0
## [106]  -4110.0   3238.6    831.0   2284.0  -3583.0  -6527.0   -294.0
## [113]  -6083.0   2974.0  -4188.0   -724.0   -531.0
</code></pre>

<pre><code class="r">means[length(means)]
</code></pre>

<pre><code>## [1] -531
</code></pre>

<pre><code class="r">
### para ploteo..  La densidad promedio!! coly1=4

### para ploteo..
min1 &lt;- min(means) - 1000
min1
</code></pre>

<pre><code>## [1] -24898
</code></pre>

<pre><code class="r">max1 &lt;- max(means) + 1000
max1
</code></pre>

<pre><code>## [1] 11075
</code></pre>

<pre><code class="r">step &lt;- (max1 - min1)/length(means)

## Para ver la informacion de los bandwidths
print(&quot;Info Density BW&quot;)
</code></pre>

<pre><code>## [1] &quot;Info Density BW&quot;
</code></pre>

<pre><code class="r">dw &lt;- density(means, bw = 100)
dw1 &lt;- density(means, bw = 500)
dw2 &lt;- density(means, bw = 1000)
dw3 &lt;- density(means, bw = 1500)

utils::str(dw)  ## 
</code></pre>

<pre><code>## List of 7
##  $ x        : num [1:512] -24198 -24130 -24063 -23995 -23927 ...
##  $ y        : num [1:512] 5.38e-07 2.89e-06 9.82e-06 2.15e-05 3.08e-05 ...
##  $ bw       : num 100
##  $ n        : int 117
##  $ call     : language density.default(x = means, bw = 100)
##  $ data.name: chr &quot;means&quot;
##  $ has.na   : logi FALSE
##  - attr(*, &quot;class&quot;)= chr &quot;density&quot;
</code></pre>

<pre><code class="r">#################################### Para la interpolacion..
f_inter_dw &lt;- approxfun(dw$x, dw$y)
#################################### 

### Para extraer los valores del histograma!!
mydata_hist &lt;- hist(means, seq(min1, max1, step), prob = TRUE, plot = FALSE)
</code></pre>

<pre><code>## Warning: argument &#39;probability&#39; is not made use of
</code></pre>

<pre><code class="r">## mydata_hist$count

utils::str(mydata_hist)  ## 
</code></pre>

<pre><code>## List of 6
##  $ breaks  : num [1:118] -24898 -24591 -24283 -23976 -23668 ...
##  $ counts  : int [1:117] 0 0 0 1 0 0 0 0 0 1 ...
##  $ density : num [1:117] 0.00 0.00 0.00 2.78e-05 0.00 ...
##  $ mids    : num [1:117] -24744 -24437 -24129 -23822 -23514 ...
##  $ xname   : chr &quot;means&quot;
##  $ equidist: logi TRUE
##  - attr(*, &quot;class&quot;)= chr &quot;histogram&quot;
</code></pre>

<pre><code class="r">
#################################### Para la interpolacion..
f_inter_dat &lt;- approxfun(mydata_hist$mids, mydata_hist$density)
#################################### 

### Finalmente cosntruyo el chisq.. f_inter_dat(dw$x) print(&#39;Separa --&#39;) dw$y
i_chisq0 &lt;- which(f_inter_dat(dw$x) != &quot;NA&quot;)
i_chisq1 &lt;- which(f_inter_dat(dw1$x) != &quot;NA&quot;)
i_chisq2 &lt;- which(f_inter_dat(dw2$x) != &quot;NA&quot;)
i_chisq3 &lt;- which(f_inter_dat(dw3$x) != &quot;NA&quot;)

### 
chisq0 = sum((f_inter_dat(dw$x[i_chisq0]) - dw$y[i_chisq0])^2)
chisq1 = sum((f_inter_dat(dw1$x[i_chisq1]) - dw1$y[i_chisq1])^2)
chisq2 = sum((f_inter_dat(dw2$x[i_chisq2]) - dw2$y[i_chisq2])^2)
chisq3 = sum((f_inter_dat(dw3$x[i_chisq3]) - dw3$y[i_chisq3])^2)

### Imprimo..
chisq0
</code></pre>

<pre><code>## [1] 1.172e-07
</code></pre>

<pre><code class="r">chisq1
</code></pre>

<pre><code>## [1] 1.796e-07
</code></pre>

<pre><code class="r">chisq2
</code></pre>

<pre><code>## [1] 2.454e-07
</code></pre>

<pre><code class="r">chisq3
</code></pre>

<pre><code>## [1] 2.502e-07
</code></pre>

<pre><code class="r">

## interpolo..  yinter1=f_inter(vel[j])

# lines(density(means, bw=&#39;SJ&#39;, adjust=1/6),col=coly1,lwd=5)

## Los errores de otra linea!!
typ1 = 2

# lines(dw1,col=coly1,lwd=5,lty=typ1)


####### Aqui meto los errores de Patrcik de 3mA en lambda #######

## El error en wavelength
deltaL = 0.02
Lambda0_1 = 5
Lambda0_2 = 10
Lambda0_3 = 15
Lambda0_4 = 20
## error en velocidad
deltaV1 = deltaL/Lambda0_1 * cluz
deltaV2 = deltaL/Lambda0_2 * cluz
deltaV3 = deltaL/Lambda0_3 * cluz
deltaV4 = deltaL/Lambda0_4 * cluz

###################################################################### Super analysis de peaks and valleys..

sims_global[sims_global == 0] &lt;- NA
means_global &lt;- rowMeans(sims_global, na.rm = TRUE)
length(means_global)
</code></pre>

<pre><code>## [1] 117
</code></pre>

<pre><code class="r">means_global
</code></pre>

<pre><code>##   [1]  -2972.4 -19944.2  -7252.5 -10443.0  -6302.3  -5208.2   1572.6
##   [8]   1526.0 -11294.9 -20746.1  -7492.4 -19013.0 -14118.8  -4380.4
##  [15]  -6768.4    436.6  -1895.6   5185.4   3192.4  -8398.0   -805.0
##  [22]  -6561.5  -7053.0 -14756.6  -4670.4  -9373.1    962.1  -4137.2
##  [29]   4279.0  -3076.9    875.5   1126.8  -5973.4   3716.6  -8672.1
##  [36]  -1784.5  -8320.8  -5168.3  -3341.5  -3437.9   2126.9 -12053.0
##  [43]  -8266.2  -4398.0    925.1   4843.0  -9118.1  -6897.9  -6169.5
##  [50]  -5476.2  -8054.2   -413.3  -4600.0   3935.2  -1728.7  -4812.4
##  [57]  -4545.6  -1490.8  -5619.4  -4059.0   -874.2  -1022.0   3549.1
##  [64]  -1196.0  -6200.9  -7623.6  -5988.1  -3382.0  -2798.2    -98.5
##  [71]  -5982.9  -4390.0  -4691.1    154.3  -2381.6  -7562.5  -4750.0
##  [78]  -6193.3  -1005.1  -4033.3    661.6   -406.1   2466.7   3282.0
##  [85]  -6081.9  -4706.3  -2242.0   -845.5   1842.0   3868.4  -4135.0
##  [92]  -4236.3  -1831.2  -2371.0    616.9  -1031.7   -193.7   1084.5
##  [99]  -2326.9  -5170.1  -3171.5  -2535.5  -1514.3  -6140.9   -400.3
## [106]  -2839.3    702.3    315.3    561.7  -1793.7   -884.1   -586.0
## [113]  -6083.0  -1044.9  -2207.2   -675.7   -531.0
</code></pre>

<pre><code class="r">means_global[116]
</code></pre>

<pre><code>## [1] -675.7
</code></pre>

<pre><code class="r">i_good_NO_unknows = which(means_global != &quot;NaN&quot;)
means_global &lt;- means_global[i_good_NO_unknows]
print(&quot;De nuevo..&quot;)
</code></pre>

<pre><code>## [1] &quot;De nuevo..&quot;
</code></pre>

<pre><code class="r">length(means_global)
</code></pre>

<pre><code>## [1] 117
</code></pre>

<pre><code class="r">means_global
</code></pre>

<pre><code>##   [1]  -2972.4 -19944.2  -7252.5 -10443.0  -6302.3  -5208.2   1572.6
##   [8]   1526.0 -11294.9 -20746.1  -7492.4 -19013.0 -14118.8  -4380.4
##  [15]  -6768.4    436.6  -1895.6   5185.4   3192.4  -8398.0   -805.0
##  [22]  -6561.5  -7053.0 -14756.6  -4670.4  -9373.1    962.1  -4137.2
##  [29]   4279.0  -3076.9    875.5   1126.8  -5973.4   3716.6  -8672.1
##  [36]  -1784.5  -8320.8  -5168.3  -3341.5  -3437.9   2126.9 -12053.0
##  [43]  -8266.2  -4398.0    925.1   4843.0  -9118.1  -6897.9  -6169.5
##  [50]  -5476.2  -8054.2   -413.3  -4600.0   3935.2  -1728.7  -4812.4
##  [57]  -4545.6  -1490.8  -5619.4  -4059.0   -874.2  -1022.0   3549.1
##  [64]  -1196.0  -6200.9  -7623.6  -5988.1  -3382.0  -2798.2    -98.5
##  [71]  -5982.9  -4390.0  -4691.1    154.3  -2381.6  -7562.5  -4750.0
##  [78]  -6193.3  -1005.1  -4033.3    661.6   -406.1   2466.7   3282.0
##  [85]  -6081.9  -4706.3  -2242.0   -845.5   1842.0   3868.4  -4135.0
##  [92]  -4236.3  -1831.2  -2371.0    616.9  -1031.7   -193.7   1084.5
##  [99]  -2326.9  -5170.1  -3171.5  -2535.5  -1514.3  -6140.9   -400.3
## [106]  -2839.3    702.3    315.3    561.7  -1793.7   -884.1   -586.0
## [113]  -6083.0  -1044.9  -2207.2   -675.7   -531.0
</code></pre>

<pre><code class="r">means_global[length(means_global)]
</code></pre>

<pre><code>## [1] -531
</code></pre>

<pre><code class="r">

############################################### Para ver la informacion de los bandwidths
print(&quot;Info Density BW&quot;)
</code></pre>

<pre><code>## [1] &quot;Info Density BW&quot;
</code></pre>

<pre><code class="r">dw1_global &lt;- density(means_global, bw = 500)

dw1_global$x
</code></pre>

<pre><code>##   [1] -22246.100 -22189.483 -22132.865 -22076.248 -22019.631 -21963.013
##   [7] -21906.396 -21849.779 -21793.161 -21736.544 -21679.926 -21623.309
##  [13] -21566.692 -21510.074 -21453.457 -21396.840 -21340.222 -21283.605
##  [19] -21226.988 -21170.370 -21113.753 -21057.136 -21000.518 -20943.901
##  [25] -20887.284 -20830.666 -20774.049 -20717.432 -20660.814 -20604.197
##  [31] -20547.579 -20490.962 -20434.345 -20377.727 -20321.110 -20264.493
##  [37] -20207.875 -20151.258 -20094.641 -20038.023 -19981.406 -19924.789
##  [43] -19868.171 -19811.554 -19754.937 -19698.319 -19641.702 -19585.084
##  [49] -19528.467 -19471.850 -19415.232 -19358.615 -19301.998 -19245.380
##  [55] -19188.763 -19132.146 -19075.528 -19018.911 -18962.294 -18905.676
##  [61] -18849.059 -18792.442 -18735.824 -18679.207 -18622.589 -18565.972
##  [67] -18509.355 -18452.737 -18396.120 -18339.503 -18282.885 -18226.268
##  [73] -18169.651 -18113.033 -18056.416 -17999.799 -17943.181 -17886.564
##  [79] -17829.947 -17773.329 -17716.712 -17660.095 -17603.477 -17546.860
##  [85] -17490.242 -17433.625 -17377.008 -17320.390 -17263.773 -17207.156
##  [91] -17150.538 -17093.921 -17037.304 -16980.686 -16924.069 -16867.452
##  [97] -16810.834 -16754.217 -16697.600 -16640.982 -16584.365 -16527.747
## [103] -16471.130 -16414.513 -16357.895 -16301.278 -16244.661 -16188.043
## [109] -16131.426 -16074.809 -16018.191 -15961.574 -15904.957 -15848.339
## [115] -15791.722 -15735.105 -15678.487 -15621.870 -15565.253 -15508.635
## [121] -15452.018 -15395.400 -15338.783 -15282.166 -15225.548 -15168.931
## [127] -15112.314 -15055.696 -14999.079 -14942.462 -14885.844 -14829.227
## [133] -14772.610 -14715.992 -14659.375 -14602.758 -14546.140 -14489.523
## [139] -14432.905 -14376.288 -14319.671 -14263.053 -14206.436 -14149.819
## [145] -14093.201 -14036.584 -13979.967 -13923.349 -13866.732 -13810.115
## [151] -13753.497 -13696.880 -13640.263 -13583.645 -13527.028 -13470.411
## [157] -13413.793 -13357.176 -13300.558 -13243.941 -13187.324 -13130.706
## [163] -13074.089 -13017.472 -12960.854 -12904.237 -12847.620 -12791.002
## [169] -12734.385 -12677.768 -12621.150 -12564.533 -12507.916 -12451.298
## [175] -12394.681 -12338.063 -12281.446 -12224.829 -12168.211 -12111.594
## [181] -12054.977 -11998.359 -11941.742 -11885.125 -11828.507 -11771.890
## [187] -11715.273 -11658.655 -11602.038 -11545.421 -11488.803 -11432.186
## [193] -11375.568 -11318.951 -11262.334 -11205.716 -11149.099 -11092.482
## [199] -11035.864 -10979.247 -10922.630 -10866.012 -10809.395 -10752.778
## [205] -10696.160 -10639.543 -10582.926 -10526.308 -10469.691 -10413.074
## [211] -10356.456 -10299.839 -10243.221 -10186.604 -10129.987 -10073.369
## [217] -10016.752  -9960.135  -9903.517  -9846.900  -9790.283  -9733.665
## [223]  -9677.048  -9620.431  -9563.813  -9507.196  -9450.579  -9393.961
## [229]  -9337.344  -9280.726  -9224.109  -9167.492  -9110.874  -9054.257
## [235]  -8997.640  -8941.022  -8884.405  -8827.788  -8771.170  -8714.553
## [241]  -8657.936  -8601.318  -8544.701  -8488.084  -8431.466  -8374.849
## [247]  -8318.232  -8261.614  -8204.997  -8148.379  -8091.762  -8035.145
## [253]  -7978.527  -7921.910  -7865.293  -7808.675  -7752.058  -7695.441
## [259]  -7638.823  -7582.206  -7525.589  -7468.971  -7412.354  -7355.737
## [265]  -7299.119  -7242.502  -7185.884  -7129.267  -7072.650  -7016.032
## [271]  -6959.415  -6902.798  -6846.180  -6789.563  -6732.946  -6676.328
## [277]  -6619.711  -6563.094  -6506.476  -6449.859  -6393.242  -6336.624
## [283]  -6280.007  -6223.389  -6166.772  -6110.155  -6053.537  -5996.920
## [289]  -5940.303  -5883.685  -5827.068  -5770.451  -5713.833  -5657.216
## [295]  -5600.599  -5543.981  -5487.364  -5430.747  -5374.129  -5317.512
## [301]  -5260.895  -5204.277  -5147.660  -5091.042  -5034.425  -4977.808
## [307]  -4921.190  -4864.573  -4807.956  -4751.338  -4694.721  -4638.104
## [313]  -4581.486  -4524.869  -4468.252  -4411.634  -4355.017  -4298.400
## [319]  -4241.782  -4185.165  -4128.547  -4071.930  -4015.313  -3958.695
## [325]  -3902.078  -3845.461  -3788.843  -3732.226  -3675.609  -3618.991
## [331]  -3562.374  -3505.757  -3449.139  -3392.522  -3335.905  -3279.287
## [337]  -3222.670  -3166.053  -3109.435  -3052.818  -2996.200  -2939.583
## [343]  -2882.966  -2826.348  -2769.731  -2713.114  -2656.496  -2599.879
## [349]  -2543.262  -2486.644  -2430.027  -2373.410  -2316.792  -2260.175
## [355]  -2203.558  -2146.940  -2090.323  -2033.705  -1977.088  -1920.471
## [361]  -1863.853  -1807.236  -1750.619  -1694.001  -1637.384  -1580.767
## [367]  -1524.149  -1467.532  -1410.915  -1354.297  -1297.680  -1241.063
## [373]  -1184.445  -1127.828  -1071.211  -1014.593   -957.976   -901.358
## [379]   -844.741   -788.124   -731.506   -674.889   -618.272   -561.654
## [385]   -505.037   -448.420   -391.802   -335.185   -278.568   -221.950
## [391]   -165.333   -108.716    -52.098      4.519     61.137    117.754
## [397]    174.371    230.989    287.606    344.223    400.841    457.458
## [403]    514.075    570.693    627.310    683.927    740.545    797.162
## [409]    853.779    910.397    967.014   1023.632   1080.249   1136.866
## [415]   1193.484   1250.101   1306.718   1363.336   1419.953   1476.570
## [421]   1533.188   1589.805   1646.422   1703.040   1759.657   1816.274
## [427]   1872.892   1929.509   1986.126   2042.744   2099.361   2155.979
## [433]   2212.596   2269.213   2325.831   2382.448   2439.065   2495.683
## [439]   2552.300   2608.917   2665.535   2722.152   2778.769   2835.387
## [445]   2892.004   2948.621   3005.239   3061.856   3118.474   3175.091
## [451]   3231.708   3288.326   3344.943   3401.560   3458.178   3514.795
## [457]   3571.412   3628.030   3684.647   3741.264   3797.882   3854.499
## [463]   3911.116   3967.734   4024.351   4080.968   4137.586   4194.203
## [469]   4250.821   4307.438   4364.055   4420.673   4477.290   4533.907
## [475]   4590.525   4647.142   4703.759   4760.377   4816.994   4873.611
## [481]   4930.229   4986.846   5043.463   5100.081   5156.698   5213.316
## [487]   5269.933   5326.550   5383.168   5439.785   5496.402   5553.020
## [493]   5609.637   5666.254   5722.872   5779.489   5836.106   5892.724
## [499]   5949.341   6005.958   6062.576   6119.193   6175.811   6232.428
## [505]   6289.045   6345.663   6402.280   6458.897   6515.515   6572.132
## [511]   6628.749   6685.367
</code></pre>

<pre><code class="r">dw1_global$y
</code></pre>

<pre><code>##   [1] 7.784e-08 1.087e-07 1.502e-07 2.046e-07 2.746e-07 3.635e-07 4.746e-07
##   [8] 6.115e-07 7.779e-07 9.800e-07 1.222e-06 1.504e-06 1.827e-06 2.191e-06
##  [15] 2.595e-06 3.038e-06 3.516e-06 4.025e-06 4.557e-06 5.102e-06 5.651e-06
##  [22] 6.195e-06 6.724e-06 7.230e-06 7.707e-06 8.147e-06 8.538e-06 8.884e-06
##  [29] 9.184e-06 9.439e-06 9.650e-06 9.820e-06 9.951e-06 1.005e-05 1.011e-05
##  [36] 1.014e-05 1.015e-05 1.013e-05 1.010e-05 1.004e-05 9.969e-06 9.884e-06
##  [43] 9.789e-06 9.686e-06 9.582e-06 9.478e-06 9.379e-06 9.285e-06 9.198e-06
##  [50] 9.116e-06 9.038e-06 8.958e-06 8.870e-06 8.767e-06 8.641e-06 8.486e-06
##  [57] 8.296e-06 8.064e-06 7.787e-06 7.456e-06 7.081e-06 6.665e-06 6.214e-06
##  [64] 5.736e-06 5.238e-06 4.731e-06 4.224e-06 3.728e-06 3.253e-06 2.806e-06
##  [71] 2.391e-06 2.012e-06 1.671e-06 1.370e-06 1.108e-06 8.877e-07 7.035e-07
##  [78] 5.503e-07 4.248e-07 3.235e-07 2.429e-07 1.798e-07 1.311e-07 9.476e-08
##  [85] 6.814e-08 4.831e-08 3.375e-08 2.324e-08 1.577e-08 1.055e-08 6.974e-09
##  [92] 4.605e-09 3.146e-09 2.253e-09 1.803e-09 1.735e-09 2.039e-09 2.760e-09
##  [99] 4.001e-09 5.928e-09 8.997e-09 1.355e-08 2.012e-08 2.946e-08 4.250e-08
## [106] 6.041e-08 8.467e-08 1.170e-07 1.611e-07 2.195e-07 2.948e-07 3.904e-07
## [113] 5.101e-07 6.576e-07 8.371e-07 1.052e-06 1.310e-06 1.615e-06 1.966e-06
## [120] 2.363e-06 2.806e-06 3.295e-06 3.825e-06 4.392e-06 4.991e-06 5.614e-06
## [127] 6.248e-06 6.883e-06 7.510e-06 8.116e-06 8.691e-06 9.227e-06 9.713e-06
## [134] 1.013e-05 1.048e-05 1.076e-05 1.096e-05 1.108e-05 1.111e-05 1.107e-05
## [141] 1.094e-05 1.072e-05 1.043e-05 1.006e-05 9.631e-06 9.143e-06 8.605e-06
## [148] 8.027e-06 7.420e-06 6.794e-06 6.163e-06 5.541e-06 4.937e-06 4.362e-06
## [155] 3.825e-06 3.333e-06 2.894e-06 2.517e-06 2.211e-06 1.972e-06 1.803e-06
## [162] 1.704e-06 1.677e-06 1.720e-06 1.834e-06 2.017e-06 2.275e-06 2.595e-06
## [169] 2.972e-06 3.399e-06 3.871e-06 4.379e-06 4.915e-06 5.469e-06 6.031e-06
## [176] 6.588e-06 7.130e-06 7.649e-06 8.138e-06 8.589e-06 9.000e-06 9.365e-06
## [183] 9.680e-06 9.945e-06 1.017e-05 1.035e-05 1.048e-05 1.059e-05 1.066e-05
## [190] 1.070e-05 1.071e-05 1.070e-05 1.067e-05 1.062e-05 1.056e-05 1.049e-05
## [197] 1.041e-05 1.033e-05 1.025e-05 1.016e-05 1.008e-05 1.000e-05 9.923e-06
## [204] 9.844e-06 9.763e-06 9.680e-06 9.594e-06 9.504e-06 9.415e-06 9.331e-06
## [211] 9.258e-06 9.204e-06 9.179e-06 9.195e-06 9.264e-06 9.405e-06 9.630e-06
## [218] 9.944e-06 1.035e-05 1.086e-05 1.148e-05 1.219e-05 1.300e-05 1.390e-05
## [225] 1.489e-05 1.595e-05 1.706e-05 1.823e-05 1.944e-05 2.069e-05 2.196e-05
## [232] 2.327e-05 2.459e-05 2.595e-05 2.731e-05 2.869e-05 3.008e-05 3.147e-05
## [239] 3.285e-05 3.421e-05 3.553e-05 3.679e-05 3.799e-05 3.911e-05 4.014e-05
## [246] 4.109e-05 4.193e-05 4.268e-05 4.332e-05 4.389e-05 4.438e-05 4.482e-05
## [253] 4.523e-05 4.560e-05 4.597e-05 4.633e-05 4.671e-05 4.712e-05 4.755e-05
## [260] 4.801e-05 4.852e-05 4.909e-05 4.971e-05 5.040e-05 5.118e-05 5.209e-05
## [267] 5.312e-05 5.430e-05 5.565e-05 5.718e-05 5.890e-05 6.083e-05 6.296e-05
## [274] 6.531e-05 6.782e-05 7.045e-05 7.315e-05 7.587e-05 7.854e-05 8.109e-05
## [281] 8.345e-05 8.552e-05 8.723e-05 8.855e-05 8.946e-05 8.993e-05 8.997e-05
## [288] 8.960e-05 8.887e-05 8.780e-05 8.651e-05 8.510e-05 8.367e-05 8.229e-05
## [295] 8.107e-05 8.007e-05 7.938e-05 7.905e-05 7.917e-05 7.969e-05 8.062e-05
## [302] 8.192e-05 8.356e-05 8.548e-05 8.761e-05 8.989e-05 9.220e-05 9.444e-05
## [309] 9.652e-05 9.836e-05 9.988e-05 1.010e-04 1.017e-04 1.019e-04 1.015e-04
## [316] 1.006e-04 9.922e-05 9.739e-05 9.516e-05 9.260e-05 8.979e-05 8.682e-05
## [323] 8.378e-05 8.078e-05 7.792e-05 7.526e-05 7.287e-05 7.079e-05 6.906e-05
## [330] 6.770e-05 6.673e-05 6.616e-05 6.591e-05 6.597e-05 6.627e-05 6.680e-05
## [337] 6.750e-05 6.833e-05 6.926e-05 7.027e-05 7.131e-05 7.236e-05 7.342e-05
## [344] 7.447e-05 7.552e-05 7.654e-05 7.755e-05 7.853e-05 7.948e-05 8.040e-05
## [351] 8.128e-05 8.212e-05 8.291e-05 8.365e-05 8.434e-05 8.498e-05 8.558e-05
## [358] 8.615e-05 8.671e-05 8.727e-05 8.787e-05 8.851e-05 8.924e-05 9.007e-05
## [365] 9.104e-05 9.215e-05 9.340e-05 9.480e-05 9.632e-05 9.794e-05 9.964e-05
## [372] 1.014e-04 1.030e-04 1.046e-04 1.060e-04 1.072e-04 1.082e-04 1.087e-04
## [379] 1.090e-04 1.088e-04 1.082e-04 1.071e-04 1.057e-04 1.039e-04 1.019e-04
## [386] 9.964e-05 9.721e-05 9.470e-05 9.220e-05 8.978e-05 8.752e-05 8.548e-05
## [393] 8.369e-05 8.220e-05 8.101e-05 8.015e-05 7.960e-05 7.935e-05 7.931e-05
## [400] 7.944e-05 7.967e-05 7.994e-05 8.018e-05 8.034e-05 8.033e-05 8.008e-05
## [407] 7.957e-05 7.879e-05 7.771e-05 7.633e-05 7.467e-05 7.274e-05 7.058e-05
## [414] 6.819e-05 6.566e-05 6.304e-05 6.035e-05 5.765e-05 5.496e-05 5.233e-05
## [421] 4.976e-05 4.730e-05 4.496e-05 4.273e-05 4.062e-05 3.862e-05 3.674e-05
## [428] 3.497e-05 3.330e-05 3.175e-05 3.031e-05 2.898e-05 2.776e-05 2.666e-05
## [435] 2.568e-05 2.484e-05 2.415e-05 2.363e-05 2.331e-05 2.317e-05 2.323e-05
## [442] 2.348e-05 2.392e-05 2.456e-05 2.537e-05 2.635e-05 2.749e-05 2.872e-05
## [449] 3.003e-05 3.137e-05 3.271e-05 3.402e-05 3.525e-05 3.638e-05 3.734e-05
## [456] 3.811e-05 3.869e-05 3.905e-05 3.918e-05 3.909e-05 3.877e-05 3.823e-05
## [463] 3.747e-05 3.654e-05 3.545e-05 3.425e-05 3.297e-05 3.163e-05 3.027e-05
## [470] 2.891e-05 2.758e-05 2.631e-05 2.511e-05 2.399e-05 2.294e-05 2.196e-05
## [477] 2.105e-05 2.020e-05 1.939e-05 1.862e-05 1.785e-05 1.707e-05 1.628e-05
## [484] 1.547e-05 1.462e-05 1.374e-05 1.283e-05 1.188e-05 1.092e-05 9.955e-06
## [491] 8.993e-06 8.048e-06 7.130e-06 6.252e-06 5.423e-06 4.659e-06 3.962e-06
## [498] 3.332e-06 2.771e-06 2.277e-06 1.849e-06 1.483e-06 1.174e-06 9.211e-07
## [505] 7.165e-07 5.504e-07 4.175e-07 3.125e-07 2.307e-07 1.680e-07 1.206e-07
## [512] 8.574e-08
</code></pre>

<pre><code class="r">
# lines(dw1_global,col=coly1,lwd=5)
plot(dw1_global, col = coly1, lwd = 5, xlab = xtitle1, ylim = c(0, 0.00018), 
    cex.axis = 1.3, cex.lab = 1.4, xlim = c(-25000, 8500), main = &quot;&quot;)

### para ver ticks usa esto.. axis(1, at=c(-21142,-1269,429,3203,4902) )


## arrows(x,y+upper, x, y-lower, angle=90, code=3, length=length, ...)
upper = 0.00015/20
lower = upper
mylength = 0.03
mylwd = 4
#### (1) ##############################################
mycol = &quot;black&quot;
pos1 = 0.00018
## pto inicial
v11 = 1000
v12 = pos1
## pto final
v21 = v11 + deltaV1
v22 = pos1
#### segments(v11,v12,v21,v22, col=mycol,lty=1,lwd=4) arrows(v11,v12, v21, v22,
#### angle=90, code=3, length=mylength, col=mycol,lty=1,lwd=mylwd)

#### (2) ##############################################
mycol = &quot;red&quot;
pos1 = 0.00017
## pto inicial
v11 = 1000
v12 = pos1
## pto final
v21 = v11 + deltaV2
v22 = pos1
#### segments(v11,v12,v21,v22, col=mycol,lty=1,lwd=4) arrows(v11,v12, v21, v22,
#### angle=90, code=3, length=mylength, col=mycol,lty=1,lwd=mylwd)


#### (3) ##############################################
mycol = &quot;green&quot;
pos1 = 0.00016
## pto inicial
v11 = 1000
v12 = pos1
## pto final
v21 = v11 + deltaV3
v22 = pos1
#### segments(v11,v12,v21,v22, col=mycol,lty=2,lwd=4) arrows(v11,v12, v21, v22,
#### angle=90, code=3, length=mylength, col=mycol,lty=1,lwd=mylwd)


#### (4) ##############################################
mycol = &quot;darkblue&quot;
pos1 = 0.00015
## pto inicial
v11 = 1000
v12 = pos1
## pto final
v21 = v11 + deltaV4
v22 = pos1
#### segments(v11,v12,v21,v22, col=mycol,lty=2,lwd=4) arrows(v11,v12, v21, v22,
#### angle=90, code=3, length=mylength, col=mycol,lty=1,lwd=mylwd)





## Aqui el indice del Nh
i_Nh = 9
# myNh_str&lt;-paste(as.character(format(myNh[i_Nh],digits=2)),sep = &#39; &#39;,
# collapse = NULL)
lege1 &lt;- expression(paste(&quot;Average velocity p.d.f&quot;))
lege2 &lt;- expression(paste(&quot;Individual Comps.&quot;))
# lege3&lt;-expression(paste(&#39;Total function&#39;))
legend(&quot;topleft&quot;, inset = 0.05, c(lege1, lege2), horiz = F, lty = c(1, 2), col = c(&quot;blue&quot;, 
    &quot;red&quot;))
############################## 


### Text (b) mtext(&#39;(b)&#39;, 4, line=2) text(5000,0.00015, &#39;(b)&#39;,cex=1.5)



###################################################################### 




#################################### Para la interpolacion..
f_inter_dw &lt;- approxfun(dw1_global$x, dw1_global$y)
#################################### 


################################################################################ Para el calculo de mdot y Lkinec ##########################

## Abre un dispositivo..  Esto es para nh&lt;1e13 myfile_wt4 &lt;-
## &#39;/Users/josem/IVIC_2012/myfits/New_NGC3783_R/COG_new_xstar6.13/Plots_paper/Final_density.txt&#39;
## Esto es para nh&lt;1e18 -- Nuevo after Javivi
myfile_wt4 &lt;- &quot;/Users/josem/IVIC_2012/myfits/New_NGC3783_R/COG_new_xstar6.13_nhe18_BUT_41_lines_ID/Plots_paper/Final_density.txt&quot;
### Todo en vel2
den2 &lt;- read.table(myfile_wt4, header = T)
den2
</code></pre>

<pre><code>##    logxi.2.08 Line X. X16 X3.16e.22 X3.85e.09 X3.85e.09.1 X3.32e.03
## 1  logxi=1.15 Line  =  31  3.16e+22  7.12e+08    7.12e+08   0.00357
## 2  logxi=2.08 Line  =  31  1.00e+23  9.55e+08    9.55e+08   0.00356
## 3  logxi=1.15 Line  =  33  1.00e+22  7.12e+08    7.12e+08   0.00182
## 4  logxi=2.08 Line  =  34  3.16e+22  7.92e+10    1.34e+16   0.00343
## 5  logxi=2.83 Line  =  38  3.16e+23  2.20e+10    3.14e+17   0.00323
## 6  logxi=2.08 Line  =  41  1.00e+22  6.11e+10    6.11e+10   0.00264
## 7  logxi=2.83 Line  =  60  3.16e+23  3.56e+10    3.02e+17   0.00331
## 8  logxi=2.08 Line  =  65  3.16e+23  7.33e+09    8.27e+13   0.00466
## 9  logxi=1.15 Line  =  79  1.00e+22  9.37e+10    9.83e+15   0.00189
## 10 logxi=2.83 Line  =  84  1.00e+22  7.22e+11    2.47e+13   0.00395
## 11 logxi=2.08 Line  =  85  3.16e+22  5.43e+11    1.79e+17   0.00350
## 12 logxi=2.83 Line  =  87  3.16e+22  5.29e+11    3.27e+13   0.00362
## 13 logxi=2.08 Line  =  88  3.16e+22  6.79e+10    2.13e+17   0.00344
## 14 logxi=2.83 Line  =  90  3.16e+23  9.21e+10    9.21e+10   0.00599
## 15 logxi=2.08 Line  =  92  3.16e+21  7.94e+11    8.64e+17   0.00173
## 16 logxi=2.08 Line  =  93  1.00e+23  9.21e+10    9.21e+10   0.00567
## 17 logxi=2.83 Line  =  93  3.16e+23  2.92e+08    2.92e+08   0.00567
## 18 logxi=2.08 Line  =  94  3.16e+22  9.37e+10    6.41e+16   0.00453
## 19 logxi=2.83 Line  =  97  1.00e+23  7.66e+05    1.58e+10   0.00311
## 20 logxi=2.83 Line  =  99  3.16e+23  2.30e+07    2.86e+11   0.00460
## 21 logxi=2.08 Line  = 101  3.16e+21  4.71e+10    4.71e+10   0.00200
## 22 logxi=1.15 Line  = 106  1.00e+22  1.90e+10    1.90e+10   0.00481
## 23 logxi=2.08 Line  = 106  1.00e+23  5.37e+14    9.05e+16   0.00654
## 24 logxi=1.15 Line  = 108  1.00e+22  9.54e+09    9.54e+09   0.00479
## 25 logxi=2.83 Line  = 108  1.00e+23  7.38e+10    7.38e+10   0.00348
## 26 logxi=2.83 Line  = 109  1.00e+19  8.88e+11    8.27e+13   0.00639
## 27 logxi=2.83 Line  = 109  1.00e+19  1.76e+16    5.02e+16   0.00475
## 28 logxi=2.83 Line  = 110  1.00e+20  9.28e+11    7.71e+16   0.01080
## 29 logxi=2.08 Line  = 111  3.16e+22  1.21e+05    2.88e+09   0.01010
## 30 logxi=2.83 Line  = 116  3.16e+23  4.76e+10    5.51e+16   0.00202
## 31 logxi=2.83 Line  = 117  3.16e+23  7.34e+05    6.75e+08   0.00491
##    X3.32e.03.1     s_xv X4724  R
## 1     0.003570  si_viii  1078 UR
## 2     0.003560     si_x  7590 UR
## 3     0.001820  si_viii  6623 UR
## 4     0.003430   mg_xii  8088 UR
## 5     0.003240  fe_xxiv -8834  R
## 6     0.002640    mg_xi  4825  R
## 7     0.001310    na_xi -1282  R
## 8     0.004670    ne_ix -7845  R
## 9     0.003420     ne_x -4438  R
## 10    0.002340   fe_xxi  3056  R
## 11    0.003510    fe_xx -6402  R
## 12    0.001580    fe_xx -2360  R
## 13    0.003450    fe_xx  -890  R
## 14    0.005990    fe_xx  4072  R
## 15    0.000394    ne_ix -2569 UR
## 16    0.005670    ne_ix  -855  R
## 17    0.005670   fe_xix -2577  R
## 18    0.003340    ne_ix   938  R
## 19    0.001690 fe_xviii  -656  R
## 20    0.003210 fe_xviii  2914  R
## 21    0.002000   o_viii -6460  R
## 22    0.004810   o_viii -4110  R
## 23    0.004810  fe_xvii  -709  R
## 24    0.004790   o_viii   831  R
## 25    0.003480   o_viii   831  R
## 26    0.004780    fe_xv  2284  R
## 27    0.006380    fe_xv  2284  R
## 28    0.010800   fe_xvi -3583  R
## 29    0.008250   fe_vii  2135  R
## 30    0.001120    n_vii  -724 UR
## 31    0.003550    n_vii  -531  R
</code></pre>

<pre><code class="r">## Luego las cantidades..
logxi1 &lt;- den2[, 1]
## inferior
x1 &lt;- den2[, 6]
x1 &lt;- log10(x1)
x1
</code></pre>

<pre><code>##  [1]  8.852  8.980  8.852 10.899 10.342 10.786 10.551  9.865 10.972 11.859
## [11] 11.735 11.723 10.832 10.964 11.900 10.964  8.465 10.972  5.884  7.362
## [21] 10.673 10.279 14.730  9.980 10.868 11.948 16.246 11.968  5.083 10.678
## [31]  5.866
</code></pre>

<pre><code class="r">## superior
x2 &lt;- den2[, 7]
x2 &lt;- log10(x2)
x2
</code></pre>

<pre><code>##  [1]  8.852  8.980  8.852 16.127 17.497 10.786 17.480 13.918 15.993 13.393
## [11] 17.253 13.515 17.328 10.964 17.937 10.964  8.465 16.807 10.199 11.456
## [21] 10.673 10.279 16.957  9.980 10.868 13.918 16.701 16.887  9.459 16.741
## [31]  8.829
</code></pre>

<pre><code class="r">### columna para mdot
x1_col &lt;- den2[, 5]

##### 
i_log_low &lt;- which(logxi1 == &quot;logxi=1.15&quot;)
i_log_low
</code></pre>

<pre><code>## [1]  1  3  9 22 24
</code></pre>

<pre><code class="r">i_log_mid &lt;- which(logxi1 == &quot;logxi=2.08&quot;)
i_log_mid
</code></pre>

<pre><code>##  [1]  2  4  6  8 11 13 15 16 18 21 23 29
</code></pre>

<pre><code class="r">i_log_hig &lt;- which(logxi1 == &quot;logxi=2.83&quot;)
i_log_hig
</code></pre>

<pre><code>##  [1]  5  7 10 12 14 17 19 20 25 26 27 28 30 31
</code></pre>

<pre><code class="r">
### 
x_mid = (x1 + x2)/2

########################################################### sacados de INDI.. val1=13.48214655436 val1=7.27108892903784
########################################################### val1=7.34749991637355 al incluir 109.. val1_hig=16.4731081924796 Los
########################################################### outliers los saque con outliers package..
val1 = 13.48214655436
i_outliers_low = which(abs(x_mid[i_log_low] - val1) == min(abs(x_mid[i_log_low] - 
    val1)))
i_outliers_low
</code></pre>

<pre><code>## [1] 3
</code></pre>

<pre><code class="r">### 
val1 = 7.27108892903784
i_outliers_mid = which(abs(x_mid[i_log_mid] - val1) == min(abs(x_mid[i_log_mid] - 
    val1)))
i_outliers_mid
</code></pre>

<pre><code>## [1] 12
</code></pre>

<pre><code class="r">### 
val1 = 16.4731081924796
i_outliers_hig = which(abs(x_mid[i_log_hig] - val1) == min(abs(x_mid[i_log_hig] - 
    val1)))
i_outliers_hig
</code></pre>

<pre><code>## [1] 11
</code></pre>

<pre><code class="r">### 
i_log_low &lt;- i_log_low[-i_outliers_low]
i_log_mid &lt;- i_log_mid[-i_outliers_mid]
i_log_hig &lt;- i_log_hig[-i_outliers_hig]
########################################################### 


print(&quot;xi_low&quot;)
</code></pre>

<pre><code>## [1] &quot;xi_low&quot;
</code></pre>

<pre><code class="r">print(x1[i_log_low])
</code></pre>

<pre><code>## [1]  8.852  8.852 10.279  9.980
</code></pre>

<pre><code class="r">
## Mean low
mean(x_mid[i_log_low])
</code></pre>

<pre><code>## [1] 9.491
</code></pre>

<pre><code class="r">sd(x_mid[i_log_low])
</code></pre>

<pre><code>## [1] 0.7471
</code></pre>

<pre><code class="r">

## Mean Mid
mean(x_mid[i_log_mid])
</code></pre>

<pre><code>## [1] 12.73
</code></pre>

<pre><code class="r">sd(x_mid[i_log_mid])
</code></pre>

<pre><code>## [1] 2.174
</code></pre>

<pre><code class="r">

## Mean hig
mean(x_mid[i_log_hig])
</code></pre>

<pre><code>## [1] 11.49
</code></pre>

<pre><code class="r">sd(x_mid[i_log_hig])
</code></pre>

<pre><code>## [1] 2.478
</code></pre>

<pre><code class="r">### 

### Ahora columnas!!
x1_col_low &lt;- mean(x1_col[i_log_low])
x1_col_mid &lt;- mean(x1_col[i_log_mid])
x1_col_hig &lt;- mean(x1_col[i_log_hig])
############################## 

x1_col_low
</code></pre>

<pre><code>## [1] 1.54e+22
</code></pre>

<pre><code class="r">x1_col_mid
</code></pre>

<pre><code>## [1] 6.897e+22
</code></pre>

<pre><code class="r">x1_col_hig
</code></pre>

<pre><code>## [1] 1.887e+23
</code></pre>

<pre><code class="r">
### el relativo.. LIP MIP HIP log(nH)a 9.491 ?? 0.004 12.93 ?? 0.038 11.84 ??
### 0.036 ??log(nH)b 1.050 ?? 0.004 1.900 ?? 0.038 3.000 ?? 0.036 a0c RSSd 0.392 ??
### 0.001 0.01 0.170 ?? 0.003 0.03 0.134 ?? 0.001 0.02

### Para el LIP
logn_low = 9.491
logn_low_err = 1.05
logn_low_m = logn_low - logn_low_err
logn_low_p = logn_low + logn_low_err
## 
n_low_m = 10^logn_low_m
n_low_p = 10^logn_low_p
## 
logr_low_m = 17.4
logr_low_p = 16.4
# 
r_low_m = 10^logr_low_m
r_low_p = 10^logr_low_p
## 
x1_col_low_R_m = x1_col_low/(n_low_m * r_low_m)
## menor..
x1_col_low_R_m
</code></pre>

<pre><code>## [1] 0.0002221
</code></pre>

<pre><code class="r">## mayor..
x1_col_low_R_p = x1_col_low/(n_low_p * r_low_p)
x1_col_low_R_p
</code></pre>

<pre><code>## [1] 1.764e-05
</code></pre>

<pre><code class="r">

### Para el MIP
logn_low = 12.93
logn_low_err = 2
logn_low_m = logn_low - logn_low_err
logn_low_p = logn_low + logn_low_err
## 
n_low_m = 10^logn_low_m
n_low_p = 10^logn_low_p
## 
logr_low_m = 15.6
logr_low_p = 13.7
# 
r_low_m = 10^logr_low_m
r_low_p = 10^logr_low_p
## 
x1_col_low_R_m = x1_col_low/(n_low_m * r_low_m)
## menor..
x1_col_low_R_m
</code></pre>

<pre><code>## [1] 4.545e-05
</code></pre>

<pre><code class="r">## mayor..
x1_col_low_R_p = x1_col_low/(n_low_p * r_low_p)
x1_col_low_R_p
</code></pre>

<pre><code>## [1] 3.61e-07
</code></pre>

<pre><code class="r">

### Para el HIP
logn_low = 11.84
logn_low_err = 3
logn_low_m = logn_low - logn_low_err
logn_low_p = logn_low + logn_low_err
## 
n_low_m = 10^logn_low_m
n_low_p = 10^logn_low_p
## 
logr_low_m = 16.4
logr_low_p = 13.4
# 
r_low_m = 10^logr_low_m
r_low_p = 10^logr_low_p
## 
x1_col_low_R_m = x1_col_low/(n_low_m * r_low_m)
## menor..
x1_col_low_R_m
</code></pre>

<pre><code>## [1] 0.0008862
</code></pre>

<pre><code class="r">## mayor..
x1_col_low_R_p = x1_col_low/(n_low_p * r_low_p)
x1_col_low_R_p
</code></pre>

<pre><code>## [1] 8.862e-07
</code></pre>

</body>

</html>

